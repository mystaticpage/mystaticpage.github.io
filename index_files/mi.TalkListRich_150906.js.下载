MI.TalkListRich=1;(function(){var j=UI.G,e=UI.GC;if(!window.MIApp||window.MIApp.lib)window.$=UI.G,window.$$=UI.GC;MI.tmpl.videoTool='<div class="vTools bor_bg" style="display:block"><a href="#" class="vClose"><em></em>'+_("收起")+'</a><a href="$VideoRealUrl" class="vUrl" target="_blank"><em></em>$VideoTitle</a></div>';MI.tmpl.videoThumbs='<a href="#" class="vThumbs" url="$VideoPlayUrl"><span class="mask"><em></em></span><img src="$VideoPicUrl" /></a>';MI.tmpl.videoObject='<object name="$VideoPlayID" id="$VideoPlayID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="460" height="372" >$allowScriptAccessIE<param name="wmode" value="transparent" /><param name="movie" value="$VideoPlayUrl" /><param name="allowFullScreen" value="true" /><param name="flashvars" value="playMovie=true&amp;isAutoPlay=true&amp;auto=1&amp;autoPlay=true&amp;adss=0$outhost$showend"><param name="swfversion" value="50536.0.0.0" /><param name="expressinstall" value="Scripts/expressInstall.swf" /></object>';MI.tmpl.videoEmbed='<embed name="$VideoPlayID" id="$VideoPlayID" src="$VideoPlayUrl" quality="high" pluginspage="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" type="application/x-shockwave-flash" $allowScriptAccessWb width="460" height="372" allowFullScreen="true" flashvars="playMovie=true&amp;isAutoPlay=true&amp;auto=1&amp;autoPlay=true&amp;adss=0$outhost$showend" wmode="transparent"></embed>';MI.tmpl.videoHTML5='<video width="460" height="362" controls="1" autoplay="autoplay" autobuffer="true" src="$VideoPlayUrl"></video>';MI.TalkList.prototype.creatConfirm=function(){var b=this;if(!b._confirm){b._confirm=UI.html('<div class="delChose"><span></span><br><label class="gb_btn gb_btn1"><input type="button" value="'+_("确定")+'" class="t"></label> <label class="gb_btn gb_btn5"><input type="button" value="'+_("取消")+'" class="t"></label></div>')[0];b._confirmTip=e(b._confirm,"span")[0];var a=e(b._confirm,"input");a[0].onclick=function(){try{var a=0;if(MI.TalkList.lastMusic)try{b._confirm.tid==b._confirm.parentNode.parentNode.id&&(a=1)}catch(d){}a&&(MI.TalkList.musicClose(),MI.user.fun.newMusic&&(window.MUSIC&&MUSIC.ICMusic)&&MUSIC.ICMusic.hideFlash(MI.TalkList.lastMusic))}catch(f){}b.remove(b._confirm.tid,b._confirm.type)};a[1].onclick=function(){var a=b._confirm.parentNode.parentNode,d=UI.next(a);UI.removeClass(a,"hover");UI.remove(b._confirm);d&&MI.focus(e(d,".userName a")[0])};a[1]=a[0]=null}};MI.TalkList.prototype.createCollect=function(b){var a=this;MI.app({TalkBoxRich:function(){MI.TalkBox.prototype.microTpc.call(a,b)}})};MI.TalkList.prototype.merge=function(b){var a;this.ids[b]&&((a=j(b))&&UI.remove(a),delete this.ids[b])};MI.TalkList.goCur=function(b){var a=-35,c=MI["t/mi.TalkListTab"];c&&UI.hasClass(UI.parent(c.target),"ui_tab_fixed")&&(a-=31);a+UI.getY(b)<UI.scrollY()&&window.scrollTo(0,a+UI.getY(UI.closest(b,"li,.talkListLi")))};MI.TalkList.prototype.focus=function(){if(!UI.B.ipad){var b=e(j(this.cur),".relay")[0];b&&(UI.B.ie&&(b.onfocusout=function(){"BODY"==document.activeElement.nodeName&&setTimeout(function(){try{b.focus()}catch(a){}},200)}),setTimeout(function(){b.focus()},0))}};MI.TalkList.prototype.creatBox=function(b){var a=this,c=b?UI.A(b,"id"):"",d=b?UI.A(b,"vmode"):"",f=b?UI.A(b,"data-zone")||0:0;b&&"2"==UI.A(b,"tv")&&UI.A(b,"tvs");var g="relayListBox_"+c;if(1==a.type||2==a.type||4==a.type)MI.tmpl.reply=MI.tmpl.reply.replace(/<div class="sendList uploadPic".*?<\/div>/ig,"");a.talkBoxTmpl=MI.tmpl.reply;a._talk=UI.html(a.talkBoxTmpl)[0];b=MI.user.fun.syncQzone?"checked":"";c=1==a.type||2==a.type||4==a.type?"none":"";a._relay=UI.html(a.talkBoxTmpl.replace('<div class="left"></div>','<div class="left" style="display:"><label style="display:'+c+';"></label></div>'))[0];a._comt=UI.html(a.talkBoxTmpl.replace('<div class="left"></div>','<div class="left"><label style="display:"><input id="replayListCheckbox" type="checkbox" class="check1">'+_("同时转播")+'</label> <label style="display:'+c+';"><input type="checkbox"  '+b+' class="replayQzoneCheckbox check1">'+_("评论到空间")+"</label></div>"))[0];b=UI.html(a.talkBoxTmpl)[0];c=e(b,".inputTxt")[0];UI.A(c,"guide",_("评论本条微博"));UI.addClass(b,"comtWrap zfWrap mt10 lcWrap");a._listComt=b;var i=[],b=[];if(!a.insTalkbox||a.relayListMulti){c=1;if(1==a.type||2==a.type||4==a.type)c=0;f=a.talkBoxTmpl.replace("talkWrap",2==a.type||4==a.type||2==f||d?"zfWrap comtWrap":"zfWrap").replace('<div class="left"></div>','<div class="left" style="display:;"><label style="display:'+(1==a.type||1==f?"":"none")+';"><input id="replayListCheckbox" type="checkbox"'+(c?" checked":"")+' class="check1">'+_("同时转播")+'</label> <label style="display:'+(1==a.type||2==a.type||4==a.type?"none":"")+';"></label></div>').replace("talkSuc","");if(a.relayListBox)var h=function(){a[g]=null;UI.linkEvent.remove(h)};a.insTalkbox||(d=UI.html(f)[0],i=[new MI.TalkBox(a._talk),new MI.TalkBox(a._relay),new MI.TalkBox(a._comt),new MI.TalkBox(a._listComt),new MI.TalkBox(d)],b=["replyBox","relayBox","comtBox","relayListComtBox","relayListBox"]);a.relayListMulti&&!a[g]&&(d=UI.html(f)[0],a[g]={},i.push(new MI.TalkBox(d)),b.push(g),UI.linkEvent.add("MI.talkList.clear",h));b.length&&UI.each(b,function(b,c){for(var d in a[b])i[c][d]=a[b][d];i[c].addListTmp=i[c].addList;a[b]=i[c];a[b]._txt.id=a[b]._txt.name=b+"_"+MI.random()});if(!a.insTalkbox){a.replyBox.guideTextKeep=0;a.replyBox.autoHeight=30;a.replyBox.txtTipSend=_("发送中");a.replyBox._btn.title=_("发送");a.relayBox.autoHeight=136;a.relayBox.txtTipSend=_("转播中");a.relayBox._btn.title=_("转播");a.relayBox._numSon=e(a.relayBox._body,".number")[0];a.relayBox._relayCheck=e(a.relayBox._body,".check1")[0]||UI.DC("b");UI.EA(a.relayBox._txt,"focus",function(){a.listComtHide()});a.relayBox._relayList&&UI.remove(a.relayBox._relayList);a.relayBox._relayList=UI.html('<div class="relayList bgr3" style="display:none"></div>')[0];UI.append(a.relayBox._relayList,a.relayBox._body);a.comtBox.autoHeight=136;a.comtBox.txtTipSend=_("评论中");a.comtBox._btn.title=_("评论");a.comtBox._numSon=e(a.comtBox._body,".number")[0];a.comtBox._relayCheck=e(a.comtBox._body,".check1")[0]||UI.DC("b");a.comtBox._relayCheckLabel=a.comtBox._relayCheck.parentNode;a.comtBox.addListCheck=0;a.comtBox._relayCheck.onclick=function(){var b=this.checked;a.comtBox.type=b?1:5;a.comtBox._tip.innerHTML="";a.comtBox.countTxt();if(!a.comtBox.addList||a.comtBox.addListCheck){a.comtBox.addList=b?a.relayBox.addList:0;a.comtBox.addListCheck=1}MI.Bos("btnRelayistCheckbox")};if(1==a.type||2==a.type||4==a.type)a.comtBox._btn.title=_("评论");UI.EA(a.comtBox._txt,"focus",function(){a.listComtHide()});a.comtBox._relayList&&UI.remove(a.comtBox._relayList);a.comtBox._relayList=UI.html('<div class="relayList bgr3" style="display:none"></div>')[0];UI.append(a.comtBox._relayList,a.comtBox._body);a.relayListComtBox.autoHeight=17;a.relayListComtBox.guideTextKeep=0;a.relayListComtBox.txtTipSend=_("评论中");a.relayListComtBox.type=5;a.relayListComtBox._btn.title=_("评论");a.relayListComtBox._btn.value=_("评论");if(a.relayListData)for(var k in a.relayListData)a.relayListComtBox.data[k]=a.relayListData[k];UI.EA(a.relayListComtBox._txt,"focus",function(){a.relayListComtBox.autoHeight=136;a.relayListComtBox.countTxt()});UI.EA(a.relayListComtBox._txt,"blur",function(){a.relayListComtBox.autoHeight=17;a.relayListComtBox.countTxt()});a.relayListComtBox.success=function(b){a.listComtHide();a.listCommentCall&&a.listCommentCall(b)};UI.EA(a.relayListComtBox._body,"click",function(a){UI.E(a).stop()});UI.EA(a.relayListBox._txt,"focus",function(){a.listComtHide()});a.replyBox.hideCall=a.relayBox.hideCall=a.comtBox.hideCall=function(){UI.removeClass(j(a.cur),"cur");a.showComtReply(j(a.cur))};a.replyBox.start=a.relayBox.start=a.comtBox.start=function(){a.checkTalkId();a.talkBox._txt.blur();a.focus()};a.replyBox.success=a.relayBox.success=a.comtBox.success=function(b,c){if(c)UI.hide(a.talkBox._relayList);else{a.talkBox.hide();a.talkBox.display=0;UI.removeClass(j(a.cur),"hover")}if(a._relayNum){UI.each(a._relayNum,function(b,c){a.talkBox.type!=1&&c||MI.countNum(b,1)});a._relayNum=null}a.relayCall&&a.talkBox.type==1?a.relayCall(b):a.replyCall&&a.talkBox.type==2?a.replyCall(b):a.commentCall&&(a.talkBox.type==4||a.talkBox.type==5)&&a.commentCall(b);a.collapseInit();UI.linkEvent("MI.TalkList.talkSuccess",{target:j(a.talkBox.talkId),type:a.talkBox.type})};UI.B.ipad&&UI.EA(a.relayBox._txt,"focus",function(){setTimeout(function(){MI.selectTxt(a.relayBox._txt,0,0,0)},100)});UI.EA(a.replyBox._close,"click",function(){a.collapseInit()});UI.EA(a.relayBox._close,"click",function(){a.collapseInit()});UI.EA(a.comtBox._close,"click",function(){a.collapseInit()});a.insTalkbox=1;a.relayListMulti||(a._creatBox=a.creatBox,a.creatBox=function(b){a.relayBox._relayCheck.checked=MI.user.fun.syncQzone?true:false;a.relayListMulti&&a._creatBox(b)})}}};MI.TalkList.reportReaded={};MI.TalkList.prototype.reportRead=function(b){MI.user.fun.reportRead&&(b.id&&!MI.TalkList.reportReaded[b.id])&&(MI.ajax({url:MI.url.reportRead,type:"get",data:b}),MI.TalkList.reportReaded[b.id]=1)};MI.TalkList.prototype.report=function(b,a,c,d){var f=this,c=c?c:0,d=d?d:{qid:"",zone:""};if(a.innerHTML!=_("举报")){var d=e(j(b),".userName a")[0]||e(j(b),".msgCnt strong a")[0],g=a="",a="";d&&(a=UI.A(d,"rel")||d.title,g=MI.string.id(d.href),a=a.replace(/\([^(]+$/g,""));var d=j(b),d=7==UI.A(d,"from")||UI.closest(d,".comtWrap")?_("评论"):_("转播"),i=g==MI.user.account;MI.confirm({type:"error",title:_("确定删除这条{0}？",d),width:320,content:i?"":'<label for="delUserRelay" class="nullFmt checkbox_item clear"><input type="checkbox"'+(MI.user.fun.delUserRelay?"checked":"")+' id="delUserRelay" align="middle" value="0"><span class="info">'+_(" 同时删除<span> {0} </span>对您的所有转播评论",MI.string.cut(a,16,"..."))+'<br>(预计两小时内清理完毕)</span></label><label for="blankHe" class="nullFmt checkbox_item clear"><input type="checkbox"'+(MI.user.fun.vipDeny?"checked":"")+' id="blankHe" align="middle" value="0"><span class="info">'+_(" 同时将<span> {0} </span>加入黑名单",MI.string.cut(a,16,"..."))+"</span></label>",confirm:function(){if(i)f.remove(b);else{var a=j("delUserRelay");MI.ajax({url:MI.url.reportSpam,data:{id:MI.string.parseInt(b),type:c||1,delUserRelay:a.checked?1:0},success:function(c){c=MI.json(c);if(c.result==0){(c=j("blankHe"))&&c.checked&&MI.ajax({url:MI.url.block,data:{u:g}});MI.user.fun.delUserRelay=a.checked?1:0;var d=j(b);UI.hasClass(d,"orginCnt")?MI.goHome():UI.animate(d,"opacity",0,function(){UI.remove(d);f.bottom()})}else c.msg&&c.result!=-1&&MI.alert(c.msg)}});var d=j("blankHe").checked?1:0;MI.Bos("writeBlackState");MI.ajax({url:MI.url.userAttr,type:"post",data:{t:299,v:d},success:function(){MI.user.fun.vipDeny=d}})}MI.dialog.hide()},cancel:function(){MI.dialog.hide()}});MI.Bos("btnReportFast")}else a=UI.A(e(j(b),".userName")[0]||e(j(b),".msgCnt strong a")[0],"rel"),1==c?(a=d.zone?d.zone:1,d=d.qid?d.qid:"",jubao_qun_msg(MI.string.parseInt(b),d,a)):(MI.Bos("btnReportMessage"),jubao_msg(MI.string.parseInt(b),a))};MI.TalkList.prototype.reportQun=function(b,a,c){c=c?c:1;UI.A(e(j(b),".userName")[0]||e(j(b),".msgCnt strong a")[0],"rel");jubao_qun_msg(MI.string.parseInt(b),a,c)};MI.TalkList.prototype.getComtReply=function(b){return e(b,".comtOrg,.relayOrg")[0]};MI.TalkList.prototype.showComtReply=function(b){MI.user.fun.comtReply&&UI.show(this.getComtReply(b))};MI.TalkList.prototype.hideComtReply=function(b){MI.user.fun.comtReply&&UI.hide(this.getComtReply(b))};MI.TalkList.prototype.repaint=function(b,a){var c=e(b,a);UI.each(c,function(a){UI.hasClass(a,"showAllCont")||(a.style.cssText="font-family:Arial",setTimeout(function(){a.style.cssText=""},0))})};MI.TalkList.prototype.showSyncQzone=function(b,a,c){b._syncQzone=b._syncQzone||e(b._body,".replayQzoneCheckbox")[0];if(b._syncQzone){var d=b._syncQzone.parentNode,f;d&&(f=d.parentNode,b.syncQzoneOld=UI.A(a,"syncQzone")?0:1,b.syncQzoneOld?(d.style.display=c?"none":"",f.style.display="",b.data.share=c?0:1*b._syncQzone.checked,b.data.syncQzone=0):(d.style.display="",f.style.display="",b.data.syncQzone=1*b._syncQzone.checked,b.data.share=0))}};MI.TalkList.prototype._iconPicToggle=function(){var b=UI.hasClass(this._body,"iconPic");UI.toggleClass(this._body,"iconPic");this.iconPic=b?0:1;MI.Crs(1);UI.each(e(this._body,".picBox"),function(a){var c=e(a,"a img");if(a=1<c.length?c[1]:c[0])1<c.length&&(""!=a.className&&"preview"!=a.className&&"crs"!=a.className)&&(a=c[0]),c=a.parentNode,"A"==c.nodeName&&c.href&&(c=c.href.replace(/460$/,""),c=b?c+"160":MI.Crs.iconPicUrl,UI.hasClass(a,"crs")?UI.A(a,"crs",c):a.src=c)})};MI.TalkList.prototype.relayListSpecial=0;MI.TalkList.prototype.isBtn=function(b){b=b.nodeName;return"A"==b||"INPUT"==b||"BUTTON"==b};MI.TalkList.prototype.getUser=function(b){var b=e(b,".userName a")[0]||e(b,".msgCnt strong a")[0],a="",c="";b&&(a=UI.text(b),c=MI.string.id(b.href));return{name:a,account:c}};MI.TalkList.prototype.events={li:function(b,a,c){if(a===this)if("mousedown"==b.type){var d=e(a,".time"),f="";2==d.length&&(d=d[0].href)&&(f=d.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g));c.reportRead({id:MI.string.parseInt(a.id),rid:f,ta:MI.user.account});if(UI.A(this,"tv")){if(UI.B.ie){if(1!=b.button)return!1}else if(b.button)return!1;UI.linkEvent("MI.TalkList.adClick",{target:b.target,el:a})}}else"mouseout"==b.type?UI.removeClass(this,"hover newMsg bg4 bor_bg5"):UI.B.ie6&&UI.addClass(this,"hover")},".relay":function(b,a,c){var d=a.id,f=e(a,".time"),g=UI.A(a,"data-zone")||0,i=e(a,".f")[0];if(c.isBtn(this)&&1!=UI.A(this,"clickE")&&c.collapse(this,1,d)){UI.A(a,"vmode");c.creatBox(a);if(1==c.isQun){var h=MI.string.parseInt(UI.A(a,"wqid"));c.relayBox.data.wqid=h}if(h=UI.A(a,"qroot"))c.relayBox.data.qroot=h;try{c.curSource=this.href.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g)}catch(k){}c.setArrowX(this,f);c.reply(d||a,1,UI.A(this,"num"));c.replyCont=UI.A(j(d)||a,"cont");c.replyTarget=this;1!=c.type&&(2!=c.type&&4!=c.type&&0==g)&&c.showSyncQzone(c.relayBox,a);MI.user.fun.newRelay2&&c.createComtList(1,d||a);i&&(UI.A(i,"href").match("event.t.qq.com")?(a=UI.A(i,"href").match(/\d+/),c.setData({_actid:a?a[0]:""})):c.setData({_actid:""}));MI.Bos("btnRelay","",0.01)}b.prevent()},".comt":function(b,a,c){var d=a.id,f=e(a,".time"),g=UI.A(a,"data-zone")||0,i=e(a,".f")[0];if(c.isBtn(this)&&1!=UI.A(this,"clickE")&&c.collapse(this,2,d)){if(MI.user.fun.shieldComt)return MI.showShieldDialog(),!1;UI.A(a,"vmode");c.creatBox(a);if(1==c.isQun){var h=MI.string.parseInt(UI.A(a,"wqid"));c.comtBox.data.wqid=h}if(h=UI.A(a,"qroot"))c.comtBox.data.qroot=h;try{c.curSource=this.href.match(/[^\/]+$/g)[0].match(/[0-9]*[0-9]/g)}catch(k){}c.setArrowX(UI.parents(this,"mFun")[0]||this,f);c.comtBox._relayCheck.checked=!1;c.comtBox._relayCheck.onclick();c.reply(d||a,2,UI.A(this,"num"));c.replyCont=UI.A(j(d)||a,"cont");c.replyTarget=this;1!=c.type&&2!=c.type&&4!=c.type&&0==g?c.showSyncQzone(c.comtBox,a,this):2==c.type||2==g?UI.hide(c.comtBox._relayCheckLabel):UI.show(c.comtBox._relayCheckLabel);c.createComtList(0,d||a);i&&(UI.A(i,"href").match("event.t.qq.com")?(a=UI.A(i,"href").match(/\d+/),c.setData({_actid:a?a[0]:""})):c.setData({_actid:""}));MI.Bos("btnComt")}b.prevent()},".reply":function(b,a,c){var d=a.id,f=e(a,".time");UI.A(a,"data-zone");c.isBtn(this)&&c.collapse(this,3)&&1!=UI.A(this,"clickE")&&(c.creatBox(a),c.setArrowX(UI.parents(this,"mFun")[0]||this,f),c.reply(d||a,0),c.replyCont=UI.A(this,"cont"),c.replyTarget=this,MI.Bos("btnReply"));b.prevent()},".relayOrg":function(b,a){UI.fireEvent(e(a,".relay")[0],"click");MI.Bos("btnSmartRelay");b.prevent()},".comtOrg":function(b,a){UI.fireEvent(e(a,".comt")[0],"click");MI.Bos("btnComtReply");b.prevent()},".delBtn":function(b,a,c){var d=a.id;1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a);3==c.type?(c.confirm(d,10),MI.Bos("btnNoticeDel")):(c.confirm(d),MI.talkBox&&6==MI.talkBox.type?MI.Bos("btnNotepadDel"):MI.Bos("btnDel"));b.prevent()},".showAllCont":function(b,a,c){c.isBtn(this)&&(UI.show(UI.next(this)),UI.remove(this));UI.proxyEvent.stop();b.prevent()},".subHover .alarm":function(b,a,c){var d=a.id;c.isBtn(this)&&(a=e(UI.closest(UI.parent(a),"li"),".replyBox")[0],MI.Group&&MI.Group.qid?(c.report(d,this,1,{qid:MI.Group.qid,zone:1}),MI.Bos("btnReport_ qun")):(c.report(d,this,a?2:1),MI.Bos("btnReport")));UI.proxyEvent.stop();b.prevent()},".alarm":function(b,a,c){a=a.id;c.isBtn(this)&&(MI.Group&&MI.Group.qid?(c.report(a,this,1,{qid:MI.Group.qid,zone:1}),MI.Bos("btnReport_ qun")):(c.report(a,this),MI.Bos("btnReport")));b.prevent()},".shareBtn a":function(b,a,c){var d=a.id;c.isBtn(this)&&(MI.user.fun.messageShare?MI.app("module/TalkList.Share",function(a){a.init({id:d})}):MI.app("TalkListShare",function(){MI.TalkList.shareCollection.show(d)}));b.prevent()},".fav":function(b,a,c){var d=a.id;if(c.isBtn(this)&&(!UI.hasClass(this,"light")||UI.A(this,"noLight")))1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.fav(d,this.type||1),UI.A(this,"noLight",1),b.stop(),MI.Bos("btnFav");b.prevent()},".fav.light":function(b,a,c){a=a.id;c.isBtn(this)&&!UI.A(this,"noLight")&&c.unfav(a);b.prevent()},".upTop":function(b,a,c){var d=a.id;c.isBtn(this)&&!UI.hasClass(this,"light")&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.upTop(d,this.type),b.stop());b.prevent()},".upTop.light":function(b,a,c){var d=a.id;c.isBtn(this)&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.upTop(d,this.type));b.stop();b.prevent()},".shield":function(b,a,c){var d=a.id;c.isBtn(this)&&!UI.hasClass(this,"light")&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),4==this.type&&c.confirm(d,this.type),MI.Bos("btnShield"));b.prevent()},".shield.light":function(b,a,c){var d=a.id;c.isBtn(this)&&(1==c.isQun&&(a=MI.string.parseInt(UI.A(a,"wqid")),MI.Group.qid=a),c.remove(d,this.type));b.stop();MI.Bos("btnUnShield");b.prevent()},".shieldUser":function(b,a,c){if(c.isBtn(this)){var d=c.getUser(a),f=d.name,g=d.account;g&&(MI.ajax({url:MI.url.sFollow,data:{op:5,u:g},success:function(a){var a=MI.json(a),b="";0==a.result&&a.info&&(a.info.following?(a.info.special&&(b='<br><br><label><input class="check1" type="checkbox" checked>'+_("取消对{0}的特别收听",f)+"</label>"),MI.confirm({type:"error",title:_("确定屏蔽{0}的广播？",f),content:'<div id="talkListShieldUser">'+_("屏蔽后，{0}的广播将不会在首页出现。<br>（不会取消收听，对方也不会知道）",UI.A(d,"gender")||"TA")+b+"</div>",confirm:function(){var a=2,b=e(j("talkListShieldUser"),"input")[0];b&&b.checked&&(a=4);MI.ajax({url:MI.url.sFollow,data:{op:a,u:g},success:function(a){a=MI.json(a);if(0==a.result)MI.tip(_("屏蔽成功！")),setTimeout(function(){location.reload()},100);else if(-11==a.result){var b=_("你可以{0}管理屏蔽{1}",'<a href="http://p.t.qq.com'+(MI.user.fun.apolloStyle?"/guanjia/fobbiduser.php":"/blocks.php")+'" target="_blank">',"</a>"),c=b;MI.user.fun.isMember&&(c=a.info?MI.user.flag.wbAnnualMember?7==a.info.wbmemberlevel?b+_(",取消部分屏蔽内容再添加"):b+_(',或<a href="http://vip.t.qq.com/intro2/growth" boss="upAnnualLevel_block" target="_blank">提升年费会员等级</a>提高屏蔽上限'):MI.user.flag.wbMember?7==a.info.wbmemberlevel?b+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):b+_(',或<a href="http://vip.t.qq.com/intro2/growth" boss="upLevel_block" target="_blank">提升微博会员等级</a>')+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):b+_(',或<a href="http://vip.t.qq.com" boss="openMember_block" target="_blank">开通微博会员</a>提高屏蔽上限'):MI.user.flag.wbAnnualMember?b+_(",取消部分屏蔽内容再添加"):MI.user.flag.wbMember?b+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):b+_(',或<a href="http://vip.t.qq.com" boss="openMember_block" target="_blank">开通微博会员</a>提高屏蔽上限'));MI.confirm({type:"error",title:_("已达到屏蔽上限！"),content:c,confirmTxt:_("知道了"),confirm:function(){MI.dialog.hide()},cancelTxt:""})}else a.msg&&MI.alert(a.msg)}})},cancel:function(){MI.dialog.hide()}})):MI.alert(_("你没有收听该用户，不能屏蔽")))}}),MI.Bos("shieldUser"))}b.prevent()},".shieldFrom":function(b,a,c){c.isBtn(this)&&!UI.hasClass(this,"light")&&(a=e(a,".ico_shield"),a.length&&(a=a[a.length-1],UI.fireEvent(a,"mouseover"),UI.fireEvent(a,"click")),MI.Bos("shieldFrom"));b.prevent()},".delRecom":function(b,a,c){a=_("来自微博推荐");if("mouseover"==b.type)return UI.A(this,"title",_("不再显示{0}的广播",a)),!1;if(c.isBtn(this)){var c=_("微博推荐"),c=_("确定屏蔽{0}？",c),d={wt:0};MI.confirm({type:"error",width:320,title:c,content:"屏蔽后，将不再显示来自好友和全站的精彩微博",confirm:function(){MI.Bos("shieldPost_confirm");MI.ajax({url:"http://api.t.qq.com/asyn/myViewSettingSave.php",type:"post",data:d,success:function(a){a=MI.json(a);0==a.result?(MI.tip(_("屏蔽成功！")),setTimeout(function(){location.reload()},100)):MI.alert(a.info||_("屏蔽操作失败，请重试"))}})}})}MI.Bos("btn_clickDelRecom");b.prevent()},".delQuanUser":function(b,a,c){c.isBtn(this)&&(a=c.getUser(a),MI.microCircle&&MI.microCircle.del_user_confirm({name:a.name,account:a.account}));b.prevent()},".ico_2dCode":function(b,a,c){var d=this;if(a=UI.A(this,"uid")){var f=function(a,b){MI.tips.show(d,'<div class="uc_2dCode"><img width="150px" height="150px" src="'+a+'"><p>扫描二维码关注'+b+"官方微信账号</p></div>");UI.show(MI.tips._arrow);MI.tips.hasOutHide=!1;c.useCodeMouseOut||(UI.EA(document.body,"click",function(){clearTimeout(MI.tips.delayOut);MI.tips.delayOut=setTimeout(function(){MI.tips.hide()},100)}),c.useCodeMouseOut=!0,UI.EA(MI.tips._body,"click",function(a){UI.E(a).stop()}))};UI.A(this,"imgUrl")&&UI.A(this,"codeName")?f(UI.A(this,"imgUrl"),UI.A(this,"codeName")):MI.ajax({url:MI.url.weixinInfo,data:{u:a},type:"get",success:function(a){a=MI.json(a);0==a.result&&(f(a.info.qrcode,a.info.nick),UI.A(d,"imgUrl",a.info.qrcode),UI.A(d,"codeName",a.info.nick))}});b.stop();b.prevent()}},".richmax_up_bar_weixin a":function(b){var a=!0;UI.hide(this);UI.hasClass(this,"weixin_close")?(a=!1,UI.show(UI.prev(this))):UI.show(UI.next(this));UI.each(e(this.parentNode.parentNode,".rich_2dCode_list li"),function(b){if(UI.A(b,"dp"))if(a){UI.show(b);UI.each(e(b,".wx_crs"),function(a){UI.removeClass(a,"wx_crs");UI.addClass(a,"crs");MI.Crs(true,b)})}else UI.hide(b)});b.stop();b.prevent()},".privacyBtn":function(b){b.prevent()},".f":function(){var b=e(this.parentNode.parentNode,".time")[0],a,c;b&&(a=MI.string.id(b.href),b=UI.A(b,"from"),c=UI.A(this,"href"),UI.A(this,"urlBoss")||(UI.A(this,"urlBoss",1),c.hasString("http://url.cn")&&UI.A(this,"href",(UI.B.ie?" ":"")+c+"?u="+MI.user.account+"&t="+a+"&msgfrom="+b+"&area=source&clickfrom=3&clickscene="+MI.sceneId())))},".time":function(){"A"==this.nodeName&&MI.Bos("btnTime")},".selectCls .popupDropBtn":function(b,a,c){this.onclick||c.selectFav(this);b.stop();b.prevent()},".replyMsg":function(b,a){var c=a.id;if(MI.talkBox)if(6==MI.talkBox.type)MI.dialog.show({width:560,title:'<h1 class="DmainTit">'+_("修改记事本")+"</h1>",html:j("talkBoxMsg")}),MI.talkBoxMsg._txt.value=UI.text(e(a,".msgCnt")[0]),MI.talkBoxMsg.talkId=MI.string.parseInt(c),MI.talkBoxMsg.countTxt(),MI.talkBoxMsg.successStart=function(b){e(a,".msgCnt")[0].innerHTML=MI.string.html(b.info.talk[0].content);MI.tip(_("修改成功"))},MI.focus(MI.talkBoxMsg._txt),MI.Bos("btnNotepadEdit");else{MI.talkBox._msgTo.value=UI.A(this,"rel");UI.removeClass(MI.talkBox._btn,"btnNoStr");MI.talkBox._txt.value="";MI.talkBox.countTxt();if(MI.dialog){MI.dialog.show({width:560,html:j("talkBoxMsg")});try{setTimeout("MI.talkBox._txt.focus()",0)}catch(d){}MI.talkBox.getMsgTo()}MI.Bos("btnReplyMsg")}b.prevent()},".areaInfo a":function(b,a,c){UI.A(this,"noPop")||(c.geolocation.show(this),MI.Bos("btn_check_location"),b.prevent())},".orderWrap,.rich_mod":function(b,a,c){var d=a.id,f,g,i=UI.hasClass(this,"rich_mod"),h=i?"open":"orderView";c.cur=d;if(!UI.A(this,"event")){var k=UI.E(b),l=e(a,".time"),t=k.target,k=t.parentNode,u=k.parentNode,x=t.nodeName,q=t,r=this,v=!i?e(r,".orderDetail")[0]:e(r,".rich_mod_in")[0],m=UI.A(r,"data"),n=e(r,"img")[0],l=l[0],S=d,p=MI.string.parseInt(d);if(v)if(q=UI.A(v,"data-tid")||UI.A(v,"data-sid"))MI.user.fun.topicSidePanel&&!UI.hasClass(a.parentNode,"LC_mini")?(MI.app({MicroTopic:function(){MI.MicroTopic.bindAndTrigger(v)}}),b.prevent()):(d=d.match(/([0-9]{5,})($|\D)/))&&d[1]&&window.open("http://t.qq.com/p/t/"+d[1]);else{if(!(q=t.className.hasString("vClose")))if(!(q=k.className.hasString("vClose")))a:{for(;t;){if(t.className.hasString("vClose")){q=!0;break a}if(t.className.hasString("rich_mod")||"BODY"==t.nodeName){q=!1;break a}t=t.parentNode}q=!1}l&&l.href&&(S=MI.string.id(l.href));var o=function(){v=e(r,".orderDetail")[0]||e(r,".rich_mod_in")[0];n=e(r,"img")[0];if(2!=m){UI.toggleClass(r,h);n&&UI.hasClass(UI.next(n),"orderInfo")&&(UI.hasClass(n,"goodsPic")||(UI.remove(n.parentNode),UI.prepend(n,v)),UI.addClass(n,"goodsPic"));var a=UI.GT(v,"iframe")[0];if(UI.hasClass(r,h)){if(a)try{"qq.com"==a.contentWindow.document.domain&&a.contentWindow.showCall&&a.contentWindow.showCall()}catch(b){a.src=a.src.split("#")[0]+"#showCall=1"}"15"==UI.A(v,"iframetype")&&MI.Bos("btnViewLongWBDetail","",0,214);MI.Bos({name:"btnViewOrderDetail",iBak1:UI.A(v,"iframeType")||"",iBak2:UI.A(v,"appId")||"",sBak1:d,id:1192});MI.mediaMutex(r);if(!UI.B.ie6)var i=setInterval(function(){if(!UI.hasClass(a,"loading")){clearInterval(i);if(UI.height(e(j(c.cur),".rich_mod_max")[0])>UI.windowHeight()){c.longWB=c.longWB||{count:0};c.longWB[c.cur]=1;c.longWB.count++}f=j("richCloser");g=j("nav_fix_wrap");if(!f&&g){UI.append(UI.html('<div class="richFloat"><a id="richCloser" class="richCloser" boss="btnFoldLongWBSide" title="收起" style="display:none"></div></div>')[0],g);f=j("richCloser");UI.EA(f,"click",function(a){UI.E(a).prevent();UI.fireEvent(e(j(c.curKey),".rich_mod")[0],"click")});UI.linkEvent.add("windowScroll",function(a){var b;c.longWB=c.longWB||{count:0};c.longWB.count?UI.each(c.longWB,function(d,g){if(g!="count"){if(b=e(j(g),".rich_mod_max")[0]){var i=UI.height(b),h=UI.getY(b);if(h<a.scrollY&&h+i>a.windowHeight+a.scrollY){UI.show(f);c.curKey=g;return true}}f&&UI.hide(f)}}):f&&UI.hide(f)})}}},200)}else{MI.Crs.iconPic="x";MI.Crs(1,e(v,".rich_min")[0]);var k=e(r,".rich_longwb_box img")[0];k&&k.complete&&(k.parentNode.style.display="",0<k.width&&50>k.width&&UI.C(k,"padding","0 30px"));MI.TalkList.goCur(v);!UI.B.ie6&&(c.longWB&&c.longWB[c.cur])&&(delete c.longWB[c.cur],c.longWB.count--,f&&UI.hide(f));if(a){try{"qq.com"==a.contentWindow.document.domain&&a.contentWindow.hideCall&&a.contentWindow.hideCall()}catch(l){a.src=a.src.split("#")[0]+"#hideCall=1"}try{a.contentWindow.hideIfr()}catch(t){}}MI.Bos({name:"btnViewOrderDetailHide",iBak1:UI.A(v,"iframeType"),iBak2:UI.A(v,"appId")||"",sBak1:d,id:1192});MI.mediaMutex(r,1)}}};if("A"!=x&&"A"!=k.nodeName&&"A"!=u.nodeName||q){if(m)o();else{if("18"==UI.A(v,"iframeType")&&(MI.Bos("btnMiTpcOpen2"),UI.hasClass(a.parentNode,"LC_mini"))){(d=d.match(/([0-9]{5,})($|\D)/))&&d[1]&&window.open("http://t.qq.com/p/t/"+d[1]);return}UI.A(r,"loading")||(MI.ajax({type:"get",url:MI.url.uploadOrder,data:{op:4,type:UI.A(v,"type")||"",iframeType:UI.A(v,"iframeType")||"",url:UI.A(v,"url")||"",msgid:S,curid:p},success:function(a){a=MI.json(a);UI.A(r,"data",1);UI.A(r,"loading",0);0==a.result&&a.info?(i?e(v,".rich_mod_max")[0].innerHTML=a.info:v.innerHTML=a.info,MI.Crs(1,e(v,".rich_max")[0])):0!=a.result&&(a.msg&&-1!=a.result&&-2!=a.result)&&MI.alert(a.msg);o()}}),UI.A(r,"loading",1))}if(q)return b.prevent(),!1}else("A"==x||"A"==k.nodeName||"A"==u.nodeName)&&MI.Bos("btnViewOrderLink")}}},".pubInfo a .sico":function(){if(MI.user.fun.hasThirdAppShield){var b=e(UI.next(UI.parent(this)),"ico_shield")[0];b&&UI.fireEvent(b,"mouseover")}},".ico_shield":function(b,a,c){var d=UI.A(a,"ispopula"),f=MI.url.thirdappshield,g;if("mouseover"==b.type)return MI.user.fun.hasThirdAppShield&&(b=e(this.parentNode,".f")[0],c="",b&&(c=b.innerHTML),UI.A(this,"fromTxt",c),UI.A(this,"title",_("不再显示{0}的广播",c))),!1;if(c.isBtn(this)&&MI.user.fun.hasThirdAppShield){var c=UI.A(this,"fromTxt"),c=_("确定屏蔽{0}的广播？",c),i="屏蔽后，来自此应用的广播将不再显示";g=e(this.parentNode.parentNode,".time")[0];g=UI.A(g,"from");var h={type:1,fromid:g};1811==g&&(c="确定关闭微博推荐功能？",i="关闭微博推荐后，精选出的好友微博将不出现在您的首页");d&&(c=_("确认对推广微博不感兴趣"),i=_("一段时间内不再显示推广微博"),UI.A(this,"orderid")?(g=e(a,".userName")[0],f="http://api.t.qq.com/tl/blockAd/block",h={clickurl:UI.A(this,"clickurl"),orderid:UI.A(this,"orderid"),id:UI.A(a,"id"),account:UI.A(g,"rel")}):(h.isPopula=1,h.tId=UI.A(a,"id")));MI.confirm({type:"error",title:c,content:i,confirm:function(){MI.Bos("shieldPost_confirm");MI.ajax({url:f,type:"post",data:h,success:function(a){a=MI.json(a);if(a.result==0)if(d&&MI.user.fun.adShield&&!MI.user.fun.adShield[0])MI.app("utils/banner",function(a){a.closeAll(0)});else if(a.isFirst){var b='以后还可以选择<br><a href="http://t.qq.com/blocks.php" target="_blank">设置&gt;屏蔽与黑名单</a> 下取消屏蔽';MI.api.type&&MI.api.type==4&&(b='可以在<a href="http://1.t.qq.com/setting#shield">设置</a>中取消对该应用的屏蔽');MI.confirm({type:"success",title:_("屏蔽成功"),content:b,width:250,confirmTxt:"",cancelTxt:"知道了",cancel:function(){setTimeout(function(){location.reload()},100)}})}else{MI.tip(_("屏蔽成功！"));setTimeout(function(){location.reload()},100)}else if(a.result==-11){var c=_("你可以{0}管理屏蔽{1}",'<a href="http://p.t.qq.com'+(MI.user.fun.apolloStyle?"/guanjia/fobbidsource.php":"/blocks.php")+'" target="_blank">',"</a>"),b=c;MI.user.fun.isMember&&(b=a.info?MI.user.flag.wbAnnualMember?a.info.wbmemberlevel==7?c+_(",取消部分屏蔽内容再添加"):c+_(',或<a href="http://vip.t.qq.com/intro2/growth" boss="upAnnualLevel_block" target="_blank">提升年费会员等级</a>提高屏蔽上限'):MI.user.flag.wbMember?a.info.wbmemberlevel==7?c+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):c+_(',或<a href="http://vip.t.qq.com/intro2/growth" boss="upLevel_block" target="_blank">提升微博会员等级</a>')+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):c+_(',或<a href="http://vip.t.qq.com" boss="openMember_block" target="_blank">开通微博会员</a>提高屏蔽上限'):MI.user.flag.wbAnnualMember?c+_(",取消部分屏蔽内容再添加"):MI.user.flag.wbMember?c+_(',或<a href="http://vip.t.qq.com" boss="uptoAnnual_block" target="_blank">升级为年费会员</a>提高屏蔽上限'):c+_(',或<a href="http://vip.t.qq.com" boss="openMember_block" target="_blank">开通微博会员</a>提高屏蔽上限'));MI.confirm({type:"error",title:_("已达到屏蔽上限！"),content:b,confirmTxt:_("知道了"),confirm:function(){MI.dialog.hide()},cancelTxt:""})}else MI.alert(a.info||_("屏蔽操作失败，请重试"))}})}});MI.Bos("btn_clickShieldIcon")}b.prevent()},".zfNum2":function(b,a,c){"A"==this.nodeName&&(c.relayListSpecial=1,c.relayListOption={url:MI.url.relayListSecond,data:{id:a.id},call:function(){}},c.collapse(this,4)&&(c.relayList&&(c.relayList.display=0),a=e(a,".zfNum"),(a=a[a.length-1])&&UI.fireEvent(a,"click"),c._collapseTarget=this),MI.Bos("btnViewRelay2"));b.prevent()},".at_stranger a":function(b,a,c){var d=this;c.relayListOption={url:MI.url.relayListAt,data:{type:3,viewModel:c.relayAtModel||0},call:function(){var a=e(d,"em")[0],b;a&&((b=UI.A(d,"num"))?(a.innerHTML="("+b+")",UI.addClass(a,"checked")):a.innerHTML="")}};c.collapse(this,4)&&(c.relayList&&(c.relayList.display=0),a=e(a,".zfNum"),(a=a[a.length-1])&&UI.fireEvent(a,"click"),c._collapseTarget=this);MI.Bos("btnViewRelayAt");b.prevent()},".at_detail a":function(b,a,c){var d=this;c.relayListSpecial=2;c.relayListOption={url:MI.url.relayListAt,data:{type:UI.A(this,"rel")||0,viewModel:c.relayAtModel||0},call:function(){var a=e(d,"em")[0],b;if(a)if(b=UI.A(d,"num")){a.innerHTML="("+b+")";UI.addClass(a,"checked");for(a=d.nextElementSibling;a;){if(b=e(a,"em")[0])b.innerHTML="";a=a.nextElementSibling}}else a.innerHTML=""}};c.collapse(this,4)&&(c.relayList&&(c.relayList.display=0),a=e(a,".zfNum"),(a=a[a.length-1])&&UI.fireEvent(a,"click"),c._collapseTarget=this);MI.Bos({name:"btnViewRelayAt",sBak2:UI.A(this,"rel")||0,id:1192});b.prevent()},".medalMsgClickBtn":function(b){var a=this;MI.app({"t/mi.Cash":function(){MI.medalMsg(a)}});b.prevent()},".eventPic":function(){var b=UI.A(this,"eventId");if(UI.A(this,"href")||!b)return!1;MI.app({TalkBoxRich:function(){MI.sendGiftShow(b)}});return!1},".tl_prepic_lk":function(b,a){var c=UI.A(a,"data-pv-ids"),d=UI.A(a,"data-pv-comt"),f={showCount:!0,allowRepeat:!0};f.defaultComt=!!d;c&&(f.idList=c.split(","));MI.cPlayer.view(UI.A(a,"tid")||a.id,f);MI.Bos("btnPicGroup");b.prevent()},".tl_imgGroup_link img,.tl_picVote_item img":function(b,a){var c=0,d=this,f=UI.A(a,"data-pv-ids"),g=UI.A(a,"data-pv-comt"),i={showCount:!0,allowRepeat:!0};i.defaultComt=!!g;f&&(i.idList=f.split(","));5===MI.api.type?i.bosCodeSBak2="web.qz.multipic":i.bosCodeSBak1="web.wide.multipic";var f=".tl_imgGroup",g=".tl_imgGroup_link img",h=UI.A(a,"tid")||a.id,k=e(a,".tl_picVote")[0];k&&(f=".tl_picVote",g=".tl_picVote_item .pic img",h=UI.A(k,"tid"),i.vote=!0,i.onVote=function(a){MI.TalkList.syncVote(h,{total:a.allCount})});UI.each(e(UI.closest(this,f),g),function(a,b){a===d&&(c=b);UI.A(a,"i",b)});MI.cPlayer.view(h+"-"+c,i);MI.Bos("btnPicGroup");MI.user.fun.newImgTmpl&&MI.Bos("btnPicBigGroup");b.prevent();return!1},".cap_panel":function(b,a,c){var d=c.getUser(a);MI.user.account!=d.account&&(MI.Bos("wideBirthTimeline"),MI.app({TalkBoxRich:function(){MI.sendGiftShow({userAccount:d.account,nick:d.name,giftType:1,successCall:function(){MI.Bos("TimelineBirthSuccess")}})}}));b.prevent()},"a.detail":function(){MI.Bos("btnViewDetail")},".btn_trans":function(b,a,c){"mouseout"==b.type?c.trans.hide():c.trans.show(this);b.prevent()},".msgCnt .ic_pic":function(b){MI.user.fun.rtPicPub&&(MI.TalkList._showPicPreview(this),b.prevent())},".readNum":function(b,a,c){var d=b.target,f=/([0-9]{5,})($|\D)/,e;b.prevent();if((b=d&&d.href&&d.href.match(f))&&b[1])b=b[1],c._collapseTarget===a&&5===c._collapseType&&c.showReadList._openByMo?(c._collapseTarget=d,c.showReadList._openByMo=!1):c.collapse(d,5)?(c.showReadList._openByMo=!1,c.showReadList(b,function(a,b){UI.A(d,"title","");UI.after(a,d.parentNode.parentNode);e=d.innerHTML.match(RegExp("([0-9.]+)("+_("万")+"?)"));e[2]&&(b=1E5<b?Math.floor(b/1E4):Math.floor(b/1E3)/10);if((e=e&&e[1])&&e<b)d.innerHTML=d.innerHTML.replace(e,b)}),MI.Bos("btnReadNum")):MI.Bos("btnReadHide")},".int_like":function(b,a,c){var a=b.target,d;b.prevent();for(b=a;b&&!b.href;)b=b.parentNode;b&&(d=(d=b.href.match(/([0-9]+)/))&&d[1]);d&&(UI.hasClass(a,"ico_likeb")?c.like(d,a):UI.hasClass(a,"ico_likea")?c.like.unlike.apply(c,[d,a]):(a=UI.GC(UI.prev(b),".ic")[0],UI.hasClass(b,"int_havelike")?c.like.unlike.apply(c,[d,a]):c.like(d,a)))},".miniMultiMedia .mMM":function(b){var a=UI.closest(this,".multiMedia"),c=e(this,"a");if(c=c.length&&c[c.length-1])if(c=c.getAttribute("href",2)||"",c.hasString("http")&&"#"!=c.slice(-1))return;var d,f;UI.hasClass(this,"mMPic")?f=".picBox .pic":UI.hasClass(this,"mMPics")?f=".tl_imgGroup_link img":UI.hasClass(this,"mMPVote")?f=".tl_picVote":UI.hasClass(this,"mMVideo")?f=".videoBox .vThumbsBox":UI.hasClass(this,"mMMusic")?f=".musicBox .mThumbsBox":UI.hasClass(this,"mMLwb")||UI.hasClass(this,"mMVote")||UI.hasClass(this,"mMRich")?f=".orderWrap,.rich_mod":UI.hasClass(this,"mMVideo")&&(f=".videoBox .vThumbsBox");f&&(d=e(a,f)[0],!d&&MI.user.fun.bigPicMode&&(a=e(a.parentNode,".mediaWrap")[0],d=e(a,f)[0]));if("click"==b.type)".tl_imgGroup_link img"==f?d=UI.isSelector(b.target,".tl_imgGroup_link img")?null:e(a,".tl_imgGroup_link img")[0]:".tl_picVote"==f?(MI.mediaMutex(d),d=null,MI.Bos({id:1192,name:"btnMiniIv"})):".orderWrap,.rich_mod"==f&&e(d,".rich_mood2")[0]&&(MI.mediaMutex(d),d=null),d&&UI.fireEvent(d,"click");else if("mouseover"==b.type&&(c=UI.A(this,"data-preview"),d))if(".picBox .pic"==f&&!c){if(a=e(d,".preview,img")[0]){a=a.cloneNode(1);if(d=UI.A(a,"crs"))a.src=d;UI.addClass(a,"preview");a.style.cssText="";UI.prepend(a,this.firstChild);a.width&&50>a.width&&(a.style.padding="0 25px")}UI.A(this,"data-preview",1)}else if(".tl_imgGroup_link img"==f&&!c){if(a=e(a,".tl_imgGroup")[0])a=a.cloneNode(1),a.style.cssText="",UI.prepend(a,this);UI.A(this,"data-preview",1)}else if(".videoBox .vThumbsBox"==f&&!c){if(a=e(d,".vThumbs")[0])a=a.cloneNode(1),a.style.cssText="",UI.A(a,"resizeto","fitfill,120x90;mode,2;max,999x2000;single,1"),f=e(a,"img")[0],d=UI.A(f,"crs"),UI.EA(f,"load",function(){MI.Crs.onLoadResize(this)}),UI.prepend(a,this.firstChild),d&&(f.src=d);UI.A(this,"data-preview",1)}b.prevent()},".videoBox .vClose":function(b){MI.TalkList.videoClose();b.prevent()},".videoBox .vThumbsBox":function(b){MI.TalkList.video&&MI.TalkList.video(this,2);b.prevent()},".msgCnt .ico_video":function(b){var a=e(this.parentNode.parentNode,".videoBox")[0];a&&a.isOpen?MI.TalkList.videoClose():MI.TalkList.video(this,1);b.prevent()},".musicBox .mThumbsBox":function(b){if(MI.user.fun.newMusic){var a=UI.parent(this);MI.app({Music:function(){MI.TalkList.music(a)}})}b.prevent()},".msgCnt .ico_music":function(b,a){if(MI.user.fun.newMusic){var c=e(a,".musicBox .mThumbsBox")[0];c&&(UI.parent(c).isOpen?MI.TalkList.musicStop():UI.fireEvent(c,"click"))}b.prevent()},".picTools .btnMobile":function(b){var a=UI.A(this,"codeurl"),c=UI.parents(this,"picBox")[0],d=e(c,".pic")[0],f=UI.height(d),g=280<f?f:280,i=e(c,".shade"),h=function(a){UI.hide(a);MI.user.fun.bigPicMode&&UI.show(e(c,".picTools")[0]);UI.removeClass(c,"pic_shade_pn")};MI.user.fun.bigPicMode&&UI.hide(e(c,".picTools")[0]);MI.app({Tmpl:function(){if(i.length)i=i[0];else{i=UI.html(MI.tmpl.picCode)[0];var b=e(i,".picUrl")[0];UI.EA(b,"load",function(){UI.removeClass(b.parentNode,"loading")});b.src=MI.token("http://api.t.qq.com/asyn/getPRCode.php?url="+a+"&size=5&margin=1");var f=e(i,".shade_close_in")[0];f&&(f.onclick=function(){MI.Bos("btnPicCodeClose");h(i);return!1});UI.after(i,d)}i.style.height=g+"px";UI.EA(i,"click",function(){h(i)});"none"!=i.style.display?h(i):(UI.addClass(c,"pic_shade_pn"),UI.show(i),MI.Bos("btnPicCodeShow"))}});MI.Bos("btnMobileToPic");b.prevent()},".picTools .btnOriginal":function(b,a){var c;(c=(c=(c=UI.parents(b.target,"msgBox")[0])&&UI.GC(c,".time")[0])&&c.href?MI.string.id(c.href):0)||(c=MI.string.parseInt(a.id));c&&MI.cPlayer.view(c,{sidebar:!1,autoAttachAlbum:!0,bosCodeSBak1:"web.wide.bigpic"});MI.Bos({name:"btnPVBig",id:1193});b.prevent()},".ui_slideshow_toolbar .icon_rotate_left":function(b,a){var c=UI.A(a,"tid")||a.id,d=UI.GC(a,".pic img")[0];MI.TalkList.newRotateImg(d,c,!1);MI.Bos("btnPicBigRotateLeft");b.prevent()},".ui_slideshow_toolbar .icon_rotate_right":function(b,a){var c=UI.A(a,"tid")||a.id,d=UI.GC(a,".pic img")[0];MI.TalkList.newRotateImg(d,c,!0);MI.Bos("btnPicBigRotateRight");b.prevent()},".LC_bigMode .picTools .btnBack":function(b,a){var c=UI.A(a,"tid")||a.id,d=UI.GC(a,".pic img")[0];MI.TalkList.newRotateImg(d,c,!1);UI.A(e(a,".picBox")[0],"style","");MI.Bos("btnPicBigRotateLeft");b.prevent()},".LC_bigMode .picTools .btnPrev":function(b,a){var c=UI.A(a,"tid")||a.id,d=UI.GC(a,".pic img")[0];MI.TalkList.newRotateImg(d,c,!0);UI.A(e(a,".picBox")[0],"style","");MI.Bos("btnPicBigRotateRight");b.prevent()},".hide_recommand":function(b,a){UI.E(b).prevent();MI.Bos("btnHideRecommand");MI.ajax({url:"http://api.t.qq.com/asyn/setHotRecExpire.php",type:"get",data:{id:a.id},success:function(b){b=MI.json(b);0==b.result&&UI.remove(a)}})}};MI.TalkList.isWeShow=function(b){var a="",c=UI.parents(b,"msgBox")[0];if(c){var b=e(c,".videoBox")[0],c=(c=e(c,".pubInfo .time")[0])?UI.A(c,"from"):"",d=["1869","1870","2020545"];if("1"==UI.A(b,"isweishi")||UI.has(d,c))b&&(a=UI.A(b,"realurl")),""!=a&&MI.Bos("goWeiShowSite")}return a};MI.TalkList.prototype._addEvent=function(b){var a=this,c=b.id;e(b,".time");var d=e(b,".zfNum"),f=d[d.length-1],d=e(b,".msgCnt")[0];e(b,".replyBox");var g=e(b,".mFun a")[0],i=e(b,".url"),h=e(b,".fileBox"),k=e(b,".musicBox,.musicAlbum"),l=e(b,".voteBox"),t=e(b,".relayList")[0],u=UI.A(b,"data-zone")||0,x=t?UI.A(t,"vmode"):0;f||(x=0,a.relayListMulti&&t?f=UI.DC("div"):t&&UI.hide(t));x&&UI.A(b,"vmode",x);a.tips_relay=_("由于用户设置，你无法转播此微博");a.tips_com=_("由于用户设置，你无法评论此微博");MI.user.fun.wideStyle&&this.useSidePanel&&(MI.sidePanelUserProfile(e(b,".msgBox strong a,.msgBox em a,.msgBox .uList_tbst li a,.msgBox .mod_tl_recom p a.BossHref,.userPic a")),MI.sidePanelTopicProfile(e(b,".msgCnt a")));!a.apiType&&MI.api.type&&(a.apiType=MI.api.type);a.openSwipeSch&&MI.app("utils/swipeSch",function(b){b(a._body)});if(f&&!f.innerHTML.hasString(_("对话"))||x){var q,r,v,m,n="",S,o=function(){a.msgMode=0;var b="";a.apiType&&(b=b+("&apiType="+a.apiType));a.xhr.relay=MI.ajax({url:this.href,type:"get",data:b,success:function(a){p(a)}});a.relayListPosition();return false},p=function(d){var f=UI.A(b,"vmode"),g=UI.A(q,"vmode"),i="relayListBox",h="relayListBox",k=t?true:false;if(a.relayListMulti){i="relayListBox_"+c;h="relayListBox_"+c}d=MI.json(d);if(UI.A(b,"rumor")&&m){m.innerHTML='<div class="lie c_tx4 cSign">'+_("此微博未经证实，请谨慎转播")+"</div>";UI.show(m)}else UI.hide(m);if(!t&&!f&&d.result!=0){d.msg&&(d.result!=-1&&d.result!=-2)&&MI.alert(d.msg);a.relayListHide()}else{UI.hide(r);!g&&!a.relayListMulti&&UI.remove(a[i]._body);if(!g){if(UI.B.ie&&a[i]&&a[i]._body){if(!a._relayListHideContainer)a._relayListHideContainer=document.createElement("div");UI.append(a[i]._body,a._relayListHideContainer)}UI.remove(a.relayListComtBox._body);t?t=null:v.innerHTML=d.info}UI.show(v);g||UI.evalScript(d.info);UI.hide(e(v,".nfunTips")[0]);g=e(v,".pages a,.tabStyle1 a,.clear .nobor a,.m_tab_2_bd a,.m_page_count a");UI.each(g,function(a){if(!UI.A(a,"target"))a.onclick=o});g=e(v,"ul.clear li");if(g.length){a.type!=1&&(a.type!=2&&a.type!=4)&&UI.addClass(g[g.length-1],"nobor");UI.each(g,function(d){UI.EA(d,"mouseover",function(){UI.addClass(this,"subHover");UI.B.safari&&a.repaint(this,".alarm")});UI.EA(d,"mouseout",function(){UI.removeClass(this,"subHover")});a.relayListMulti&&UI.A(d,"id",MI.string.parseInt(d.id)+"_relay");var g=e(d,".relayCite")[0],k=e(d,".replyCite")[0];e(d,".alarm");if(g)g.onclick=function(){if(a.relayListMulti){i="relayListBox_"+c;h="relayListBox_"+c}a[h].guideText=null;UI.show(a[h]._body);UI.addClass(a[h]._body,"zfWrap");UI.hasClass(a[h]._body,"comtWrap")&&UI.removeClass(a[h]._body,"comtWrap");UI.removeClass(a[h]._txt,"cNote");a.getRelayOld(d,".content",a[h]);a[h].txtTipSend=_("转播中");a[h]._btn.value=_("转播");if(a.type!=1&&a.type!=2&&a.type!=4&&u==0){a.showSyncQzone(a[h],b);UI.next(a[h]._syncQzone).innerHTML=a[h]._btn.value}if(a[h]._syncQzone&&a[h]._syncQzone.parentNode.style.display!="none"&&UI.A(d,"from")=="10")a[h]._syncQzone.checked=true;a[h].talkId=MI.string.parseInt(d.id);a[h]._relayCheck.checked=true;a[h]._relayCheck.onclick();(a.type==1||a.type==4)&&UI.hide(a[h]._relayCheckLabel);UI.A(v,"fRt")?w(a[h],1,a.tips_relay):w(a[h],0);a.relayListMulti?a[i].data.pgv_v="listRelay":a.talkBox.data.pgv_v="listRelay";return false};if(k)k.onclick=function(){if(MI.user.fun.relayComt){a.listComt(this);return false}if(MI.user.fun.shieldComt){MI.showShieldDialog();return false}if(a.relayListMulti){i="relayListBox_"+c;h="relayListBox_"+c}if(f){i="relayListBox_"+c;h="relayListBox_"+c}a[h].guideText=null;UI.show(a[h]._body);UI.addClass(a[h]._body,"zfWrap");UI.addClass(a[h]._body,"comtWrap");UI.removeClass(a[h]._txt,"cNote");a.getRelayOld(d,".content",a[h]);a[h].txtTipSend=_("评论中");a[h]._btn.value=_("评论");if(a.type!=1&&a.type!=2&&a.type!=4&&u==0){a.showSyncQzone(a[h],b,1);UI.next(a[h]._syncQzone).innerHTML=a[h]._btn.value}if(a[h]._syncQzone&&a[h]._syncQzone.parentNode.style.display!="none"&&(UI.A(v,"isvip")||UI.A(d,"from")=="10"))a[h]._syncQzone.checked=true;a[h].talkId=MI.string.parseInt(d.id);a[h]._relayCheck.checked=false;a[h]._relayCheck.onclick();(a.type==1||a.type==4)&&UI.show(a[h]._relayCheckLabel);UI.A(v,"fCom")?w(a[h],1,a.tips_com):w(a[h],0);a.relayListMulti?a[i].data.pgv_v="listComt":a.talkBox.data.pgv_v="listComt";return false}})}try{var l=e(q,".num")[0],j,x=e(S,".relayNum")[0],n=e(q,".num2")[0],p,A=e(b,".relayNum")[1];if(l){j=l.innerHTML;if(j==0&&e(q,"ul li").length==0){UI.hide(e(q,"ul")[0]);UI.hide(e(q,".pages")[0])}if(j>parseInt(x.innerHTML))x.innerHTML=j}if(n&&A){p=n.innerHTML;if(p>parseInt(A.innerHTML))A.innerHTML=p}}catch(z){}if(l=e(v,".relayThumb")[0]){l.nofocus=k;l.onclick=s;l.onclick()}v.onclick=function(){MI.DisableDblClickSelect(this)};if(MI.user.fun.wideStyle&&this.useSidePanel){MI.sidePanelUserProfile(e(q,".userPic a,.msgCnt strong a,.msgCnt em a,.cNote2 a,.more a"));MI.sidePanelTopicProfile(e(q,".content a"))}MI.Crs(1);a.relayListCall&&a.relayListCall(q);MI.PV("relay");(!location.hostname||location.hostname!="qun.t.qq.com")&&UI.removeClass(a[i]._body,"comtWrap");var w=function(a,b,c){if(b){a._txt.disabled=true;a._btn.disable=1;UI.addClass(a._btn,"btnNoStr");a.showTip(c,1);a.flashTip();a.tipNoChange=1}else{a.tipNoChange=0;a._txt.disabled=false;a._btn.disable=0;UI.removeClass(a._btn,"btnNoStr");a.countTxt()}};UI.A(v,"isvip",d.isvip?1:0);if(d.attr){UI.A(v,"fCom",d.attr.fCom?d.attr.fCom:0);UI.A(v,"fRt",d.attr.fRt?d.attr.fRt:0);d.attr.fRt?w(a[i],1,a.tips_relay):w(a[i],0)}else{UI.A(v,"fCom",0);UI.A(v,"fRt",0);w(a[i],0)}d=UI.A(b,"type")=="10"?1:0;if(a[h]._syncQzone&&a[i]._syncQzone.parentNode.style.display!="none")a[i]._syncQzone.checked=d?true:false;UI.linkEvent("MI.TalkList.resize")}},s=function(){UI.hide(this);var d,f=1,g="relayListBox",i="relayBox";d=UI.A(b,"vmode");var h=UI.A(q,"vmode"),k=UI.A(this,"appended"),l=this.parentNode;if(a.relayListMulti){g="relayListBox_"+c;i="relayBox"}if(a.type==1||a.type==2||a.type==4||u==2||d)f=0;if(k)UI.show(this.nextSibling);else{a.creatBox(b);e(v,".relayThumb");if(a.isQun==1){d=MI.string.parseInt(UI.A(b,"wqid"));a[g].data.wqid=d}e(b,".baoliao_icn")[0]?a[g].data.isExpose=1:delete a[g].data.isExpose;d=MI.string.parseInt(UI.A(b,"qroot"));a[g].wqRootId=d;a[g].nofocus=this.nofocus;a[g]._txt.value="";a[g].countTxt();a[g]._relayCheck=e(a[g]._body,".check1")[0];a[g]._relayCheckLabel=a[g]._relayCheck&&a[g]._relayCheck.parentNode;a[g].successStart=function(){var c=e(v,".refreshBth")[0];if(c)c.onclick();if(!MI.Nano)if(a[g].type==1){UI.A(b,"tv")!=""&&UI.linkEvent("MI.TalkList.talkSuccess",{target:b,type:"drelay"});MI.tip(_("转播成功！"));MI.Bos("btnSendRelayList")}else{MI.tip(_("评论成功！"));MI.Bos("btnSendComtList")}a.updateRelayNum(a[g].type);UI.linkEvent("MI.talkList.relayListBoxPubSucc",{target:a[g]})};a[g].start=function(){clearTimeout(void 0)};d=a[g]._body;var t=function(){UI.ER(l,"click",t);UI.replace(a[g]._body,e(l,".zfWrap")[0]);setTimeout(function(){a[g].countTxt();MI.selectTxt(a[g]._txt,0,0,0)},100)};h?UI.EA(l,"click",t):UI.after(d,this);a[g]._body.ondblclick=function(a){UI.E(a).stop()};if(!UI.B.ie)a[g]._body.onmousedown=function(a){UI.E(a).stop()};a[g]._relayCheck.onclick=function(){var b=this.checked;a[g].type=b?1:4;a[g]._tip.innerHTML="";a[g].countTxt();a[g].addList=b?a[i].addList:0;MI.Bos("btnRelayistCheckbox")};h||UI.A(this,"appended",1);if(!a.relayListMulti){a.talkBox=a[g];a.talkBox.data.pgv_v=""}}if(MI.user.fun.relayListBoxCondensed){UI.addClass(a[g]._body,"condensed");a[g].guideTextAdd(f?_("点击转播"):_("点击评论"))}else!h&&!this.nofocus&&setTimeout(function(){a[g].focus()},100);if(!f){UI.addClass(a[g]._body,"comtWrap");a[g]._relayCheck.checked=false;UI.show(a[g]._relayCheckLabel)}a[g].txtTipSend=f?_("转播中"):_("评论中");a[g]._btn.value=f?_("转播"):_("评论");a[g].addList=f?a.relayBox.addList:0;if(a.type==2||u==2){a[g].addList=1;UI.hide(a[g]._relayCheckLabel)}a[g].talkId=MI.string.parseInt(c);a[g].type=f?1:4;a[g].apiType=a.apiType;a[g].iconPic=a.iconPic;a[g].autoHeight=136;if(a.type!=1&&a.type!=2&&a.type!=4&&u==0){a.showSyncQzone(a[g],b,!f);UI.next(a[g]._syncQzone).innerHTML=a[g]._btn.value}UI.linkEvent("MI.TalkList.RelayListBoxInited",{target:a[g]})},A=function(d,g){d=d||window.event;UI.A(b,"data-addEvent")||UI.fireEvent(b,"mouseover");if(!a.collapse(this,4,c))return false;if(d){var i=UI.E(d).type;a.msgMode=i?0:1}var g=g?g:this,h=UI.A(b,"vmode"),k=UI.A(b,"data-zone")||0;if(!q){a.relayListMulti&&(n=c);(!a["_relayList"+n]||a.relayListMulti)&&a.relayListCreate(n,h);q=a["_relayList"+n];r=a["_relayListLoad"+n];m=a["_relayListTips"+n];v=a["_relayListCont"+n]}m&&UI.hide(m);var h=UI.A(q,"vmode"),l=e(v,".pages .left")[0];if(h)l.onclick=function(){if(UI.A(this,"expand"))return true;f.onclick();UI.A(this,"expand",1);return false};a.xhr.relay&&!a.relayListMulti&&a.xhr.relay.abort();var u=MI.string.id(g.href),l=u==c?u:c;UI.windowHeight();var x,o,A,w,s,z;if(a.relayListOption){o={};for(x in a.relayListOption)o[x]=a.relayListOption[x]}UI.A(g,"rel",u);S=g;if((!a.relayAtCur||!o)&&(i&&!a.relayListSpecial||!i&&a.relayListSpecial)&&q.display=="1"&&(a.cur==l||a.relayListMulti)&&!h)e(q,".w_close")[0].onclick();else{UI.removeClass(j(a.cur),"cur");UI.remove(a._confirm);a.replyHide();a.talkBox&&a.talkBox.hide();if(!h||!t){UI.hide(v);UI.show(r)}UI.append(q,e(b,".msgBox")[0]);a.hideComtReply(b);A=+new Date;var ma=MI.url.relayList,u={id:u,viewModel:a.iconPic||0};if(a.apiType)u.apiType=a.apiType;if(a.type==2||k==2)u.zone=2;if(o){if(o.url)ma=o.url;if(o.data)for(x in o.data)u[x]=o.data[x]}if(a.relayListData)for(x in a.relayListData)u[x]=a.relayListData[x];if(a.isReply)u.isReply=1;if(h||t){p("",b);UI.A(q,"vmode",0)}else a.xhr.relay=MI.ajax({url:ma,type:"get",data:u,success:function(a){w=+new Date-A;p(a);o&&o.call&&o.call();s=+new Date-A;setTimeout(function(){z=+new Date-A;MI.Speed("t_asyn_relay",0.1,w,s,z)},0)}});x=UI.scrollY();(k=UI.getY(g))&&k<x&&window.scrollTo(0,k);if(!h){UI.addClass(b,"cur");a.cur=l;q.display=1}MI.Bos("btnViewRelay",l)}a.relayListPosition=function(){var a=UI.getY(f);a&&UI.scrollY()>a&&window.scrollTo(0,a)};try{!h&&!a["relayListBox"+(a.relayListMulti?"_"+c:"")].nofocus&&a.focus()}catch(y){}if(i)a.relayListSpecial=0;a.relayListOption=null;UI.linkEvent("MI.TalkList.resize");return false};x&&A("",f);f.onclick=A;t&&UI.fireEvent(f,"click");a.viewRelayToMsg&&(f.onclick=null);a.viewRelayUseContainer&&(f.onclick=a.viewRelayUseContainer)}if(g){var x=g.parentNode,z,w;g.onclick=function(d){clearTimeout(z);var f=this;w=setTimeout(function(){a.moreFun(f.parentNode,c||b);MI.Bos("btnMoreFun",null,0.01)},150);if(UI.hasClass(f.parentNode,"mFunDis")){UI.hasClass(document.body,"ipad")&&setTimeout(function(){UI.removeClass(f.parentNode,"mFunDis")},200);UI.E(d).stop()}var d=e(b,".fav")[0],g=e(b,".upTop")[0],i=e(b,".shield")[0],h=e(b,".privacyBtn")[0],k;k=UI.hasClass(d,"light");if(d){d.type=k?3:1;d.innerHTML=k?_("取消收藏"):_("收藏")}k=UI.hasClass(g,"light");if(g){g.innerHTML=k?_("取消置顶"):_("置顶");g.type=k?9:8}k=UI.hasClass(i,"light");if(i){i.type=k?5:4;i.innerHTML=k?_("取消屏蔽"):_("屏蔽此消息@")}if(h){h.onmouseover=function(){UI.addClass(e(this,"a")[0],"cur");var a=e(h,".sub_fun")[0];if(a)UI.show(a);else{a=UI.html('<div class="sub_fun" style="min-height:40px;height:40px;"><p><label for="comBtn'+c+'"><input class="check1"'+(UI.A(b,"fCom")?"checked":"")+' type="checkbox" value="" id="comBtn'+c+'" name="com">禁止评论</label></p><p><label for="frtBtn'+c+'"><input class="check1"'+(UI.A(b,"fRt")?"checked":"")+' type="checkbox" value="" id="frtBtn'+c+'" name="relay">禁止转播</label></p></div>')[0];UI.append(a,this);a.onclick=function(a){UI.E(a).stop()};UI.each(e(a,"input"),function(a){a.onclick=function(d){var f=UI.A(a,"name"),g=MI.url.myViewSettingSave,e={messageid:c,r:MI.random()};if(f=="com")e.commentset=a.checked?1:0;else if(f=="relay")e.relayset=a.checked?1:0;var i=a.checked?1:0;MI.ajax({url:g,type:"post",data:e,success:function(){f=="com"?UI.A(b,"fCom",i):f=="relay"&&UI.A(b,"fRt",i)}});UI.E(d).stop()}})}};h.onmouseout=function(){UI.removeClass(e(this,"a")[0],"cur");var a=e(h,".sub_fun")[0];a&&setTimeout(function(){UI.hasClass(e(h,"a")[0],"cur")||UI.hide(a)},150)}}return false};UI.hasClass(document.body,"ipad")||(g.onmouseover=g.onclick,g.onmouseout=function(){clearTimeout(w)},x.onmouseover=function(){clearTimeout(z)},x.onmouseout=function(){z=setTimeout(function(){clearTimeout(w);a.moreFunHide()},100)})}d&&""==d.innerHTML&&!MI.user.fun.apolloStyle&&(d.innerHTML="&nbsp;");if(MI.user.fun.urlPreview&&i.length)UI.A(b,"preview")||UI.each(i,function(b){a.urlPreview.showPreview(b);return false}),UI.A(b,"preview",1);else if(MI.user.fun.wideStyle&&(MI.user.fun.wideUrlPreview&&i.length)&&!("e.t.qq.com"==window.location.hostname||"qun.t.qq.com"==window.location.hostname))UI.A(b,"preview")||UI.each(i,function(c){a.urlPreview.addPreviewIconWide(c,b);return false}),UI.A(b,"preview",1);k&&this.musicEvent(k);l&&this.voteEvent(l);h&&UI.B.win&&MI.TalkList.fileEvent(h,b)};var y,p;MI.TalkList.prototype.listComt=function(b){var a=UI.closest(b,"li"),c=a.id,d,f;this.creatBox(b);d=this.relayListComtBox;y&&UI.A(y,"cont",d._txt.value);f=UI.A(b,"cont");y==b&&p?(UI.remove(d._body),p=0):(UI.removeClass(d._btn,"disabled"),UI.removeClass(d._body,"pubSuc"),2==MI.user.fun.relayComt&&(d.guideTextValue=_("回复")+" "+this.getUser(a).name),d.addReplyComt=this.getRelayOld(a,".content"),UI.append(d._body,a),d._txt.value=f||"",d.showTip(""),d.talkId=MI.string.parseInt(c),d.guideTextAdd(d.guideTextValue),d.focus(),d.countTxt(),p=1);y=b};MI.TalkList.prototype.listComtHide=function(){UI.remove(this.relayListComtBox._body);p=0};MI.TalkList.prototype.createComtList=function(b){var a=this,c=function(b,c,d,f){b&&((b._syncQzone&&("none"!=b._syncQzone.parentNode.style.display&&f)&&(b._syncQzone.checked=!0),b._txt.disabled=!1,b._btn.disable=0,UI.removeClass(b._btn,"btnNoStr"),d)?1==b.display&&(a.tips_relay||(a.tips_relay=_("由于用户设置，你无法转播此微博"),a.tips_com=_("由于用户设置，你无法评论此微博")),b._txt.disabled=!0,b._btn.disable=1,UI.addClass(b._btn,"btnNoStr"),c=c?a.tips_relay:a.tips_com,b._relayCheckLabel&&UI.hide(b._relayCheckLabel),b.showTip(c,1),b.flashTip(),b.tipNoChange=1):(b.tipNoChange=0,b.countTxt(),b._relayCheckLabel&&UI.show(b._relayCheckLabel)))};if(a.comtBoxList){var d=a.cur,f=j(d);UI.A(f,"vmode");var g=UI.A(f,"data-zone")||0,i=b?a.relayBox:a.comtBox,h=b?a.relayBox._relayList:a.comtBox._relayList,k=e(f,".comt")[0],l=e(f,".relay")[0],t=e(f,".replyBox")[0],u,x=function(){var c={t:b?1:2};a.apiType&&(c.apiType=a.apiType);a.xhr.comt=MI.ajax({url:this.href,type:"get",data:c,success:function(a){q(a);MI.selectTxt(i._txt,0,0,0)}});if(c=e(f,".zfNum")[0])(c=UI.getY(c))&&UI.scrollY()>c&&window.scrollTo(0,c);return!1},q=function(d){d=MI.json(d);if(0==d.result){UI.remove(a.relayListComtBox._body);h.innerHTML=d.info;(b&&t||!b)&&UI.show(h);UI.evalScript(d.info);var u=d.isvip?1:0,q="10"==UI.A(f,"from")?1:0,q=u&&!b||q;UI.A(f,"isvip",u);d.attr?(UI.A(f,"fCom",d.attr.fCom?d.attr.fCom:0),UI.A(f,"fRt",d.attr.fRt?d.attr.fRt:0),d.attr.fRt&&b||d.attr.fCom&&!b?c(i,b,1,q):c(i,b,0,q)):(UI.A(f,"fCom",0),UI.A(f,"fRt",0),c(i,b,0,q));if(d=e(h,".num,.num2")[0])if(d=d.innerHTML)if(u=e(a.relayBox._body,".number a")[0],q=b?l:k,u&&(u.innerHTML=u.innerHTML.replace(/\d+/g,d),UI.A(q,"num",d)),MI.user.fun.newRelay2&&t)q.innerHTML=q.innerHTML.replace(/\d+/g,d),UI.A(q,"num",d),q.title&&(q.title=q.title.replace(/\d+/g,d));d=e(h,".pages a,.tabStyle1 a,.clear .nobor a,.m_tab_2_bd a,.m_page_count a");UI.each(d,function(a){if(!UI.A(a,"target"))a.onclick=x});d=e(h,"li");d.length&&(MI.PV("comt"),UI.addClass(d[d.length-1],"nobor"),UI.each(d,function(b){b.onmouseover=function(){UI.addClass(this,"subHover");UI.B.safari&&a.repaint(this,".alarm")};b.onmouseout=function(){UI.removeClass(this,"subHover")};try{var d=e(b,".relayCite")[0],h=e(b,".replyCite")[0];e(b,".alarm");if(d)d.onclick=function(){UI.addClass(i._body,"zfWrap");if(a.type==1||a.type==2||a.type==4||g){UI.hasClass(i._body,"talkWrap")&&UI.removeClass(i._body,"talkWrap");UI.hide(i._relayCheckLabel)}UI.hasClass(i._body,"comtWrap")&&UI.removeClass(i._body,"comtWrap");UI.removeClass(i._txt,"cNote");a.getRelayOld(b,".content",i);i.txtTipSend=_("转播中");i._btn.value=_("转播");i._btn.title=_("转播");if(a.type!=1&&a.type!=2&&a.type!=4&&g==0){a.showSyncQzone(i,f);UI.next(i._syncQzone).innerHTML=i._btn.value}i.type=1;i.talkId=MI.string.parseInt(b.id);var d=UI.A(b,"from")=="10"?1:0;UI.A(f,"fRt")?c(i,1,1,d):c(i,1,0,d);a.talkBox.data.pgv_v="listRelay";return false};if(h)h.onclick=function(){if(MI.user.fun.relayComt){a.listComt(this);return false}if(MI.user.fun.shieldComt)MI.showShieldDialog();else{UI.addClass(i._body,"zfWrap");UI.addClass(i._body,"comtWrap");UI.removeClass(i._txt,"cNote");a.getRelayOld(b,".content",i);i.txtTipSend=_("评论中");i._btn.value=_("评论");i._btn.title=_("评论");if(a.type!=1&&a.type!=2&&a.type!=4&&g==0){a.showSyncQzone(i,f,1);UI.next(i._syncQzone).innerHTML=i._btn.value}else UI.show(i._relayCheckLabel);i.type=5;i.addList=a.comtBox.addListTmp;i.talkId=MI.string.parseInt(b.id);var d=UI.A(f,"isvip"),e=UI.A(b,"from")=="10"?1:0,d=d||e;UI.A(f,"fCom")?c(i,0,1,d):c(i,0,0,d);a.talkBox.data.pgv_v="listComt"}return false}}catch(k){}}));h.onclick=function(){MI.DisableDblClickSelect(this)};h.ondblclick=function(b){var c=0,b=UI.E(b).target.nodeName;if(!(b=="TEXTAREA"||b=="INPUT"||b=="A")){UI.each(e(h,".pages a"),function(a){a.innerHTML.hasString(_("下一页"))&&(c=a)});if(c)c.onclick();else{i.hide();a.replyHide()}}};UI.B.ie&&(h.onmousedown=function(){h.onselectstart=null},h.onmouseup=function(){h.onselectstart=function(){return false}});MI.user.fun.wideStyle&&this.useSidePanel&&(MI.sidePanelUserProfile(e(h,".userPic a,.msgCnt strong a,.msgCnt em a,.cNote2 a,.more a")),MI.sidePanelTopicProfile(e(h,".content a")));MI.Crs(1);a.relayListCall&&a.relayListCall(h);UI.linkEvent("MI.TalkList.resize")}},r,v,n,m;r=+new Date;a.xhr.comt&&a.xhr.comt.abort();b&&(UI.addClass(i._body,"zfWrap"),UI.hasClass(i._body,"comtWrap")&&UI.removeClass(i._body,"comtWrap"),i.txtTipSend=_("转播中"),i._btn.value=_("转播"),i._btn.title=_("转播"),i.type=1,i.addList=i.addListTmp);h.innerHTML="";UI.hide(h);d={t:b?1:2,id:MI.user.fun.newRelay2&&t?UI.isElement(d)?d.id:d:a.curSource,viewModel:a.iconPic||0};UI.isArray(d.id)||(d.id=MI.string.parseInt(d.id));if(2==a.type||2==g)d.zone="2";a.apiType&&(d.apiType=a.apiType);a.isReply&&(d.isReply=1);a.xhr.comt=MI.ajax({url:MI.user.fun.newRelay2&&t?MI.url.relayListSecond:MI.url.relayList,type:"get",data:d,success:function(a){v=+new Date-r;setTimeout(function(){q(a)},0);n=+new Date-r;setTimeout(function(){m=+new Date-r;MI.Speed("t_asyn_comt",0.1,v,n,m)},100)}});u=UI.scrollY();(d=UI.getY(b?l:k))&&d<u&&window.scrollTo(0,d);i.successStart=function(){a.updateRelayNum();UI.hide(h);var b=e(h,".refreshBth")[0];if(b)b.onclick()}}else d=b?a.relayBox:a.comtBox,u=a.isvip?1:0,a.comtForbidden&&!b||a.frtForbidden&&b?c(d,b,1):c(d,b,0,u)};MI.TalkList.prototype.reply=function(b,a,c){function d(){var a=g.id;f.talkBox.talkId=isNaN(MI.string.parseInt(a))?a:MI.string.parseInt(a)}var f=this,g=j(b);UI.A(g,"vmode");var i=UI.A(g,"data-zone")||0;MI.card&&UI.remove(MI.card._body);f.relayListHide(b);if(f.talkBox&&f.replyTarget){var h=f.talkBox._txt.value+(f.talkBox.addReplyComt||"");UI.A(f.replyTarget,"cont",h);if(1==a||2==a){var k=UI.parents(f.replyTarget,"msgBox")[0];k&&(k=k.parentNode,UI.A(k,"cont",h))}}f.talkBox=2==a?f.comtBox:a?f.relayBox:f.replyBox;e(g,".baoliao_icn")[0]?f.talkBox.data.isExpose=1:delete f.talkBox.data.isExpose;f.talkBox.apiType=f.apiType;f._talk=f.talkBox._body;f.talkBox.iconPic=f.iconPic;f.talkBox.startTime=0;UI.C(f.talkBox._txt,"height","");UI.removeClass(f.talkBox._btn,"disabled");UI.removeClass(f._talk,"pubSuc");f.talkBox.data.pgv_v="";if(f.talkBox.display)f.talkBox.hide(),f.replyHide(),(1==a||2==a)&&UI.A(g,"cont",f.talkBox._txt.value);else{var k=b,l=f.cur,t=e(g,".zfNum")[0],u=e(g,".userName a")[0]||e(g,"strong a")[0],x="",q,r;e(g,".userName .vip");e(g,".userName .ico_expo");r="";var v=(h=e(g,".msgCnt")[0])?h.cloneNode(1):UI.DC("b"),h=e(g,".replyBox")[0],n=e(g,".replyBox .msgCnt")[0];e(g,".userPic");var m=f.talkBox._txt;u&&(x=u.innerHTML,r=u.title||UI.A(u,"rel"));t&&(k=t.href.match(/[^\/]+$/g)[0]);t=UI.text(v);n&&(u=UI.text(n).split(":"),a&&(q=x,x=u[0]),u=u.slice(1).join(":"));l&&UI.removeClass(j(l),"cur");UI.addClass(g,"cur");f._relayNum=a?e(g,".relayNum"):null;var o=MI.user.fun.relayComt,l="",u=_("对话是半公开的，不会出现在你听众的主页上，但是可以到你的页面看到<br>对 <b>{0}</b> 说:",x);o||(l+=_("<br>顺便说两句:"));u=2==a?"":a?l:u;if(l=e(f._talk,".replyTitle")[0])l.innerHTML=u;f.talkBox._body.className=2==a?"talkWrap comtWrap bgr3":(a?"zfWrap":"talkWrap")+" bgr3";r=MI.string.account(r);h&&q&&(1==a||2==a)&&!e(g,".view")[0]?(1==a?h=_("清空转播理由"):o?(h=_("显示{0}的评论",f.getUser(g).name),2<f.getRelayOld(g,".content,.msgCnt").split("||").length&&(h=_("显示{0}等人的评论",f.getUser(g).name)),UI.addClass(f.talkBox._addReply,"addReplyComt")):(h=_("清空评论"),UI.removeClass(f.talkBox._addReply,"addReplyComt")),f.talkBox._addReply.innerHTML='&nbsp;<a href="#">['+h+"]</a>",f.talkBox._addReply.txt=" || @"+r+": "+UI.trim(t),UI.show(f.talkBox._addReply)):UI.hide(f.talkBox._addReply);f.talkBox.talkId=isNaN(MI.string.parseInt(b))?b:MI.string.parseInt(b);f.talkBox.type=a?1:2;!f.comtBox._relayCheck.checked&&2==a&&(f.talkBox.talkId=MI.string.parseInt(b),f.talkBox.type=5);m.value="";f.talkBox.countTxt();(r=e(g,".at_detail")[0])?UI.before(f._talk,r):(r=e(g,".msgBox")[0],UI.append(f._talk,r?r:g));setTimeout(function(){if(!m.disabled){UI.A(m,"nofocus")||m.focus();f.replyCont?m.value=m.value+f.replyCont:a&&!e(g,".view")[0]&&f.getRelayOld(g,".content,.msgCnt",f.talkBox);f.talkBox.addReplyComt=a==2&&o&&n?f.getRelayOld(g,".content,.msgCnt"):"";if(f.talkBox.addReplyComt)m.value=m.value.replace(f.talkBox.addReplyComt,"");if(MI.user.fun.rtPicPub&&(a==1||a==2)){var c=MI.TalkList.rtPics[b],d,i,h;if(f.talkBox._retweetPic&&c&&c[c.key]){d=UI.html('<div class="sendList uploadPicSuccess"><i class="ic ic_pic"></i> [image'+c.key+'] <a href="javascript:;" class="ffsong" title="删除">×</a></div>')[0];i=f.talkBox._rtPicWrap;UI.hide(i);UI.after(d,i);i=UI.GC(d,"a")[0];h=UI.GC(d,"i")[0];i.onclick=function(){c[c.key]=null;f.talkBox._txt.value=f.talkBox._txt.value.replace(RegExp("\\[image"+c.key+"\\]","g"),"");c.key=null;MI.selectTxt(f.talkBox._txt,0,0,0);f.talkBox._resetRtPic();MI.Bos("btnDelRtPics")};UI.A(h,"data-rpid",c.key);UI.A(h,"data-rpurl",c[c.key]);h.onmouseover=function(){MI.TalkList.showPicPreview(h)};f.talkBox._txt.value.hasString("[image"+c.key+"]")||f.talkBox.addTopic(" [image"+c.key+"]");f.talkBox._retweetPic.used=c.key}}f.talkBox.countTxt();d=!n&&f.focusEnd?m.value.length:0;MI.selectTxt(m,d,d,d)}},50);if(0!=a){h=1>c?_("转播"):_('转播<i class="l"></i>');t=1>c?_("评论"):_('评论<i class="l"></i>');r="";l=1==a?h:t;h=1==a?"Relay":"Comt";t=1==a?"?filter=5":"?filter=6";if(UI.A(g,"rumor"))r+='<span class="lie c_tx4 cSign">'+(1==a?_("此微博未经证实，请谨慎转播"):_("此微博未经证实，请谨慎评论"))+"</span>";else{if((1==f.type||2==f.type||4==f.type)&&1!=a)l=1>c?_("评论"):_('评论<i class="l"></i>');r+=l+(o?_("本条微博"):_("原文"));l="en_US"==window.MILang?"":l;0<c&&(!MI.user.fun.newRelay2||!n)&&2!=f.type&&2!=i?r+=_("，")+'<a href="'+MI.getInternalUrl(1,k,"/"+t)+'" onclick="MI.Bos(\'btn'+h+'View\')" target="_blank">'+(0!=c&&c?_("共{0}条",c)+l:"")+'<em class="ffsong">>></em></a>':o||(r+=1==a?_("，把它分享给你的听众"):"")}2==a&&f.isReply&&(r=(1>c?_("回复"):_('回复<i class="l"></i>'))+" "+(q||x));f.talkBox._numSon.innerHTML=r}c=1==a?_("转播"):2==a?_("评论"):_("对话");f.talkBox._btn.value=c;f.cur=b;f.talkBox.display=1}if(f.replyBox.display||f.relayBox.display||f.comtBox.display)UI.addClass(j(f.cur),"cur"),UI.B.ie6&&UI.addClass(j(f.cur),"hover"),f.hideComtReply(g);f.setArrow(e(f.talkBox._body,".SA")[0]);f.checkTalkId=UI.isElement(b)?d:function(){};f.talkBox.resetRtPic(b);UI.linkEvent("MI.TalkList.resize")};MI.TalkList.prototype.replyTarget=null;MI.TalkList.prototype.replyHide=function(){UI.removeClass(j(this.cur),"cur");UI.removeClass(j(this.cur),"hover");this.talkBox&&this.talkBox.hide();UI.linkEvent("MI.TalkList.resize")};MI.TalkList.prototype.relayListOption=null;MI.TalkList.prototype.relayListCreate=function(b,a){var b=b||"",c=this,d="_relayList"+b,f="_relayListLoad"+b,g="_relayListTips"+b,i="_relayListCont"+b,h=j(b),k;h&&(k=e(h,".relayList")[0]);a&&k?(c[d]=k,c[f]=e(k," .loading")[0],c[i]=e(k," .cont")[0]):(c[d]=k||UI.html('<div class="relayList bgr3"><div class="top"><span class="left"><a href="#" class="vClose"><em></em>'+_("收起")+'</a></span><a class="w_close" href="#" title="'+_("点击关闭")+'"><b class="close">×</b></a></div><div class="loading">'+_("正在加载")+'...</div><div class="contTips"></div><div class="cont"></div></div>')[0],c[f]=e(c[d],".loading")[0],c[g]=e(c[d],".contTips")[0],c[i]=e(c[d],".cont")[0]);e(c["_relayList"+b],".w_close")[0].onclick=function(){var a=this;UI.B.ie&&UI.C(a,"left","9999px");setTimeout(function(){c.relayListHide(b);c.collapseInit();UI.C(a,"left","")},0);MI.Bos("btnRelayListClose");return false};var l=c[i];e(c[d],".left a")[0].onclick=function(){c.relayListHide(b);c.collapseInit();MI.Bos("btnRelayListUp");return false};l.ondblclick=function(a){var d=0,a=UI.E(a).target.nodeName;if(!(a=="TEXTAREA"||a=="INPUT"||a=="A")){UI.each(e(l,".pages a"),function(a){a.innerHTML.hasString(_("下一页"))&&(d=a)});if(d)d.onclick();else{c.relayListPosition();c.relayListHide(b);c.collapseInit()}MI.S("tips_relayList_"+MI.Uin(),-1)}};UI.B.ie&&(l.onmousedown=function(){l.onselectstart=null},l.onmouseup=function(){l.onselectstart=function(){return false}})};MI.TalkList.prototype.getRelayOld=function(b,a,c){var d,a=a.split(","),f=[];UI.each(a,function(a){f=f.concat(e(b,a))});d=f[0];var g=e(b,".userName strong a,.userName strong span")[0]||e(b,"strong a,strong span")[0],i,a="@",h="",k,l;g&&("A"==g.nodeName?(g.href.split("/"),i=MI.string.account(g.title||UI.A(g,"rel"))):(i=UI.text(g).replace(/(@|\/)/g,"$1 "),a=""));if(d){if(1==e(b,".time").length&&!UI.hasClass(b,"subHover")&&(k=1),d=d.cloneNode(1),!k||!c)UI.each(e(d,"strong"),function(a){UI.remove(a)}),UI.each(e(d,"em"),function(a){var b=UI.A(a,"rel");if(b)a.innerHTML=b}),UI.each(e(d,"img"),function(a){var b=(UI.A(a,"k")||"")+a.title;b&&UI.after(UI.html("<b>/"+b+"</b>")[0],a)}),UI.each(e(d,".btn_trans,.showAllCont"),function(a){UI.remove(a)}),UI.each(e(d,"i.ic_pic"),function(a){var b=UI.A(a,"data-rpid"),c=UI.A(a,"data-rpurl");if(b.match(/^[1-9]$/)&&c){l=l||{};a.innerHTML=" [image"+b+"]";l[b]=c}}),l&&(k=b.id?b.id.match(/([0-9]{5,})($|\D)/):0)&&k[1]&&(MI.TalkList.rtPics[k[1]]=l),h=" || "+a+i+": "+UI.text(d)}else i&&(h=" || "+a+i+": ");if(c){c._txt.value=h;try{UI.A(c._txt,"nofocus")||c._txt.focus(),MI.selectTxt(c._txt,0,0,0),c.countTxt()}catch(t){}}else return h};MI.TalkList.prototype.updateRelayNum=function(b){if(1==this.type||2==this.type||4==this.type||this.notUpdateRelayNum||this.notUpdateComtNum)return!1;var a=j(this.cur),b=b||this.talkBox.type,c;4==b||5==b?c=".comt":1==b&&(c=".relay");if(c&&a&&(b=e(a,c)[0]))if(UI.A(b,"num",1+parseInt(UI.A(b,"num")||0)),MI.user.fun.newRelay2&&e(a,".replyBox")[0]&&(a=UI.A(b,"num")||0,c=b.title,a&&(b.innerHTML=b.innerHTML.replace(/[(]\d+[)]/g,"")+"("+a+")"),c))b.title=c.replace(/\d+/g,a)};MI.TalkList.prototype.setArrow=function(b){b&&(b.style.cssText="left:"+(this.setArrow.x+3)+"px")};MI.TalkList.prototype.setArrowX=function(b,a){if(a=2==a.length?a[1]:a[0])this.setArrow.x=UI.getX(b)-UI.getX(a)-12+(UI.width(b)-24)/2};MI.TalkList.prototype.relayListHide=function(b){b||(b="");var a=this["_relayList"+b]||this._relayList;a&&(UI.remove(a),UI.B.ie&&(this["relayListBox_"+b]&&this["relayListBox_"+b]._body)&&(this._relayListHideContainer||(this._relayListHideContainer=document.createElement("div")),UI.append(this["relayListBox_"+b]._body,this._relayListHideContainer)),a.display=0,UI.removeClass(j(this.cur),"cur"),UI.removeClass(j(this.cur),"hover"),this.relay2Cur=this.relayAtCur=null,this.talkBox&&(this.talkBox._txt.value=""),!this.relayListMulti&&this.focus(),this.showComtReply(j(this.cur)),this.xhr.relay&&this.xhr.relay.abort());UI.linkEvent("MI.TalkList.resize")};MI.TalkList.prototype.fav=function(b,a){this.remove(b,a)};MI.TalkList.prototype.upTop=function(b,a){this.remove(b,a)};MI.TalkList.prototype.unfav=function(b){var a=j(b);1==this.isQun&&(a=parseInt(UI.A(a,"wqid")),MI.Group.qid=a);this.confirm(b,2);MI.Bos("btnUnFav")};MI.TalkList.prototype.selectFav=function(b){MI.app("TalkListFav",function(){MI.favorites&&MI.favorites.showDrop(b)});MI.Bos("btnSelectFav");return!1};MI.TalkList.prototype.remove=function(b,a,c){var b=String(b),d=this,f=j(b),g=d.removeUrl,i={},h,k,l,t=UI.A(f,"data-zone")||0;i.id=isNaN(MI.string.parseInt(b))?b:MI.string.parseInt(b);c&&(i.veriCode=c);if(a)if(8==a||9==a){if(i.op=8==a?1:2,g=8==a?"http://api.t.qq.com/tl/toptweets/add":"http://api.t.qq.com/tl/toptweets/del",!d.upTopCheck&&8==a){MI.ajax({url:"http://api.t.qq.com/tl/toptweets/getcount",type:"post",success:function(f){f=MI.json(f);if(f.result==0&&f.total==3){MI.Bos("showTopLimit");MI.confirm({title:_("确定添加置顶微博？"),content:_("最多可置顶3条微博，继续操作将会替代最早的置顶微博"),confirmTxt:_("确定"),confirm:function(){d.upTopCheck=true;d.remove(b,a,c)},cancelTxt:_("取消"),cancel:function(){d.upTopCheck=false}})}else{d.upTopCheck=true;d.remove(b,a,c)}}});return}}else g=d.favorUrl,i.op=2>a?1:2;d.mId&&(i.mId=d.mId);if((1==d.type||2==d.type||4==d.type||MI.Group)&&MI.Group.qid)i.time=e(f,".time")[0].rel,i.qid=MI.Group.qid,i.zone=d.type?t?t:d.type:MI.TalkBox.prototype.data.cflag;t=i.id;if(4==a)i={id:t,t:0},g=d.shieldUrl;else if(5==a||6==a)i={id:t,t:1},g=d.shieldUrl;10==a&&(i={id:t,r:i.r},g=d.delNoticeUrl);f.sending||(MI.ajax({url:g,data:i,type:"post",success:function(c){f.sending=0;c=MI.json(c);if(c.result==0){h=e(f,".fav")[0];k=e(f,".shield")[0];l=e(f,".upTop")[0];if(a==1){UI.addClass(h,"light");h.innerHTML=_("取消收藏");h.type=3;if(MI.user.fun.apolloStyle&&d.getUser(f).account!=MI.user.account){var g=UI.html('<i class="like_plus" style="margin-top:-10px;"><i class="ic ic_selected"></i>已收藏</i>')[0];UI.prepend(g,h);UI.animate(g,"marginTop",-21,function(){UI.remove(g)},0.2)}}else{UI.remove(d._confirm);if(a==4){UI.addClass(k,"light");k.innerHTML=_("取消屏蔽");k.type=5}else if(a==8){UI.addClass(l,"light");l.innerHTML=_("取消置顶");l.type=9;c="http://t.qq.com/"+MI.user.account;c=_("我刚置顶了一条微博，大家来看看吧~")+c+"?preview";MI.talk(_('置顶成功，把我的置顶告诉大家:&nbsp;&nbsp;<span style="color:#999">[最多置顶3条微博]</span>'),c,"50");if(MI.guest)MI.dialog.closeEnd=function(){MI.Bos("btnUpTopClose");MI.goHome("preview")};MI.talk.reply.talkBox.successStart=function(){MI.Bos("btnUpTopSend");MI.tip(_("广播成功!"),function(){MI.goHome("preview")})};MI.Bos("btnUpTop")}else{MI.talkBox&&(!a&&c.info!=7)&&MI.talkBox.countNum(-1);if(a==3){UI.removeClass(h,"light");h.innerHTML=_("收藏");h.type=1}else if(a==5){UI.removeClass(k,"light");k.innerHTML=_("屏蔽此消息@");k.type=4}else if(a==9){UI.removeClass(l,"light");l.innerHTML=_("置顶");l.type=8;MI.guest&&MI.goHome("preview");MI.Bos("btnUnUpTop")}else{d.removeCall&&d.removeCall(b);UI.addClass(f,"delMsg");setTimeout(function(){UI.hasClass(f,"orginCnt")?MI.tip(_("删除成功"),function(){MI.goHome()}):UI.animate(f,"opacity",UI.B.ie9?0.01:0,function(){var a=UI.next(f);if(UI.hasClass(f,"fill-back")&&MI.talkBox){var a=e(f,".msgCnt")[0],b="";if(a){a=a.cloneNode(1);UI.remove(e(a,"strong")[0]);UI.remove(e(a,".mediaWrap")[0]);UI.each(e(a,"em"),function(a){a.innerHTML=UI.A(a,"rel")});b=UI.trim(UI.text(a))}MI.talkBox._txt.value=b;MI.talkBox.countTxt();MI.talkBox._txt.select()}else a&&MI.focus(e(a,".userName a")[0]);UI.remove(f);delete d.ids[f.id];d.bottom()})},300)}}}UI.linkEvent("MI.TalkList.talkRemove",{target:f,type:a})}else MI.code.check(c.result)?MI.code.show({msg:c.msg,code:c.info,call:function(c){d.remove(b,a,c)}}):c.msg&&c.result!=-1&&c.result!=-2&&(a==8||a==1||c.result==-15||a==4)&&MI.alert(c.msg)}}),f.sending=1)};MI.TalkList.prototype.delRecom=function(b){var b=String(b),a=this,c=j(b);UI.animate(c,"opacity",UI.B.ie9?0.01:0,function(){UI.remove(c);a.bottom()})};MI.TalkList.prototype.confirm=function(b,a){var b=String(b),c=this,d=j(b),f=e(d,".msgBox")[0],g=e(d,".mFun")[0],i;c.creatConfirm();a&&(2==a?i=c.unfavTip:4==a?i=c.shieldTip:6==a?i=c.unShieldTip:10==a&&(i=c.noticeTip));i=a?i:c.removeTip;var h=e(d,".replyBox")[0],k=e(d,".relayNum")[0];4==a?UI.after(c._confirm,g):UI.append(c._confirm,f);c.relayListHide(b);setTimeout(function(){e(c._confirm,"input")[0].focus()},0);c._confirm.tid=d.id;c._confirm.type=a;!a&&(!h&&k)&&(i=_("这条广播已经被{0}人转播点评过，确认删除吗？",k.innerHTML));c._confirmTip.innerHTML=i;c.talkBox&&(c.talkBox.display&&c.cur==d.id)&&(UI.remove(c.talkBox._body),UI.removeClass(d,"cur"),c.talkBox.display=0)};MI.tmpl.urlPreview='<div class="urlPreview"><div class="SA" style="display:none;"><em>◆</em><span>◆</span></div><a class="close" href="javascript:void(0)"></a><div class="urlIntro"><a class="ulink" target="_blank" href="#"></a></div><div class="urlCnt"></div></div>';var w=MI.TalkList.prototype,m=function(b){var b=b||window.event,a=UI.E(b),c=0,d=1;if(b.detail){if(c=0<b.detail?1:-1,-3>b.wheelDelta||3<b.wheelDelta)d=2}else if(c=0>b.wheelDelta?1:-1,-120>b.wheelDelta||120<b.wheelDelta)d=2;var b=A.scrollHeight,f=A.offsetHeight,g=A.scrollTop;return b<=f?!0:1<d?(a.prevent(),!1):1===c&&80>b-g-f?(g!=b-f&&(A.scrollTop=b-f),a.prevent(),!1):-1===c&&80>g?(a.prevent(),A.scrollTop=0,!1):!0},n=function(){UI.hide(z)},o=function(){clearTimeout(W);W=setTimeout(n,250)},D=function(b,a){if(N[a].info&&N[a].info.html){var c;c=(c=N[a].info.url)?/[\/.](qzone\.qq|pengyou|weibo|t\.qq)\.com/.test(c):!1;c||(c=UI.html('<a title="'+_("查看预览")+'"class="tIcon ico_page" href="javascript:void(0)"></a>')[0],UI.after(c,b),c.onmouseover=function(){var b=this;na=setTimeout(function(){var c=UI.parents(b,"msgBox"),c=UI.parent(c[c.length-1]),g=[UI.getX(c)+UI.width(c)+20,UI.getY(b)];z||(z=UI.html(s.tmpl)[0],I=e(z,".ulink,.urlIntro p")[0],A=e(z,".urlCnt")[0],aa=e(z,".close")[0],oa=e(z,".SA")[0],ba=UI.DC("div"),s.navH=s.navH||(e(document.body,".tSearchNew")[0]?UI.height(j("header")||j("headWrap")):0),s._body=z,s._cnt=A,s._title=I,s._close=aa,s._arrow=oa,s.build(),aa.onclick=function(){n();MI.Bos("btnUrlPreviewClose")},UI.EA(z,"mouseover",function(){clearTimeout(W)}),UI.EA(z,"mouseout",o),UI.EA(I,"click",function(a){UI.E(a).stop()}),UI.B.ie6&&UI.EA(window,"scroll",function(){z.style.top=UI.scrollY()+5+s.navH+"px"}),UI.hasClass(document.body,"ipad")||(A.onmousewheel=m,UI.B.firefox&&A.addEventListener("DOMMouseScroll",m,!1)),window.imgLoad=window.imgLoad||function(a){if(!UI.B.ie6)return false;var b=UI.width(A);if(a.width>b)a.width=b},window.imgError=window.imgError||function(){});if(a!=pa){var i=N[a].info,h=i.html,k="";pa=a;I.href=a;h=h.replace(/<\/?(html|head|base|meta)[^>]*?>/gi,"");k+='<div class="urlDescribeBox">';try{if(i.url&&(1==i.safe||3==i.safe||4==i.safe)){var l={};l[1]=_('安全等级：<span class="t">该网站安全风险暂时未知</span>');l[3]=_('安全等级：<span class="t">暂无安全风险</span>');l[4]=_('安全等级：<span class="t">暂无安全风险</span>');var t="",u="";1==i.safe&&(t="unsafe",u='<a target="_blank" class="report" href="http://guanjia.qq.com/trojan_false.html">'+_("举报")+"</a>");var x="";i.site&&i.site.url?x=MI.string.html(decodeURIComponent(i.site.url)):(x=MI.string.html(decodeURIComponent(i.url)),x=x.match(/(http:\/\/|https:\/\/)?(www.)?[\w-]+\.(com|net|org|gov|cc|biz|info|cn|it|so)(\.(cn|hk))*/),x=0<x.length?x[0]:"");var q="";if(1==i.safe||3==i.safe||4==i.safe)q=' <a target="blank" class="c_tx3" href="http://www.scanv.com/seccenter/search/'+x.replace(/(http:\/\/|https:\/\/)/gi,"")+'">查看详情</a>';k+='<span class="safeBox clear"><em class="ico safe_'+i.safe+'"></em><span class="safeLevel '+t+'"><strong>'+_("来源网站 ")+x+'</strong><br /><a href="'+MI.string.html(decodeURIComponent(i.url)).replace(/"/g,"%22")+'" target="_blank">'+MI.string.html(decodeURIComponent(i.url))+'</a><span class="level clear"><span class="left">'+l[i.safe]+q+'</span><span class="right">'+u+'<a class="gb_btn gb_btn1" href="'+MI.string.html(decodeURIComponent(i.url)).replace(/"/g,"%22")+'" target="_blank"><span class="t">'+_("访问该链接")+"</span></a></span></span></span></span>"}}catch(r){}if(1==i.safe||3==i.safe||4==i.safe)k+='<div class="urlDescribe">\t            <p class="noDuty">安全诊断结果由<img class="scanv" src="http://mat1.gtimg.com/www/mb/images/s/scanv.png" title="" alt="">网址安全中心为您提供。<br>温馨提示：网页内容变化快，请谨慎判断安全风险。</p>       </div>';k+="</div>";h.hasString("<body>")?/<body>\s*<\/body>/i.test(h)||(k+='<div class="urlContent">'+h+"</div>"):(h=h.replace(/<title>[^<>]*?<\/title>/gi,""),h=h.replace(/<\!--[^<>]*?--\>/g,""),ba.innerHTML=h,UI.trim(UI.text(ba))&&(k+='<div class="urlContent">'+h+"</div>"));A.innerHTML=k||_("抱歉，页面没有返回数据，暂时无法预览。");I.innerHTML=i.title||i.url;UI.each(UI.GT(A,"a"),function(a){if(!a)return false;UI.EA(a,"click",function(){MI.Bos("btnUrlPreviewContLink")})})}s.setPos(g);UI.EA(c,"mouseout",o);UI.EA(c,"mouseover",function(){clearTimeout(W)});UI.show(z);MI.Bos("btnUrlPreview")},200)},c.onmouseout=function(){clearTimeout(na)})}},E=function(b,a,c){c=UI.html('<a title="'+_("查看预览")+'"class="tIcon ico_page" href="'+c+'"></a>')[0];UI.after(c,b);UI.A(b,"boss","btn_urlClick_hasPreview");c.onclick=function(){return!1};MI.sidePanelUrlProfile&&MI.sidePanelUrlProfile(e(a,"a.ico_page"))},s={navH:0,MIN_H:400,MIN_W:360,MAX_W:550},z,I,A,aa,oa,W,na,ba,pa,N={};s._body=z;s.data={};s.tmpl=MI.tmpl.urlPreview;s.build=function(){UI.append(s._body,document.body)};s.setPos=function(b){var a,c=b[0],d=b[1];a=UI.windowHeight()-10-s.navH;d=UI.windowWidth()-(UI.B.ie&&!UI.B.ie9?-5:13)-5;a=a>=s.MIN_H?a:s.MIN_H;d-b[0]>s.MAX_W?b=s.MAX_W:d-b[0]<s.MIN_W?(b=s.MIN_W,c=d-b):b=d-b[0];d=UI.scrollY()+5+s.navH;UI.B.ie6?z.style.cssText="left:"+(c-5)+"px;top:"+d+"px;width:"+b+"px;height:"+a+"px;":(z.style.cssText="left:"+(c-5)+"px;top:"+(s.navH+5)+"px;width:"+b+"px;height:"+a+"px;position:fixed",A.style.cssText="width:"+(b-20)+"px;height:"+(a-20-36)+"px;")};s.showPreview=function(b){var a=b.href;if(a)if(N[a])D(b,a);else{var c={url:a};if(s.data)for(var d in s.data)c[d]=s.data[d];MI.ajax({type:"get",url:MI.url.urlPreview,data:c,success:function(c){c=MI.json(c);N[a]=c;0==c.result&&D(b,a)}})}};s.addPreviewIconWide=function(b,a){var c=UI.A(b,"href");if(c)if(MI.Wide&&MI.Wide.urlPreviewCache&&MI.Wide.urlPreviewCache[""+c])E(b,a,c);else{var d={url:"http://api.t.qq.com/asyn/shortUrlPreview.php",type:"get",data:{url:c,r:MI.random()},success:function(d){var g=d,d=MI.json(d);0==d.result&&d.info&&(E(b,a,c),MI.Wide&&(MI.Wide.urlPreviewCache&&!MI.Wide.urlPreviewCache[""+c])&&(MI.Wide.urlPreviewCache[""+c]={data:g,getTime:+new Date}))}};MI.ajax(d)}};s.close=n;w.urlPreview=s;var V=function(b){F=UI.A(b,"pos").split(",");qa=UI.A(b,"pano");if(!(2>F.length||!UI.isNumber(1*F[0])||!UI.isNumber(1*F[1]))){var a=function(){X=[];var a=new B.LatLng(F[1],F[0]);ra.geocode({location:a},function(a,b){var c=O.getZoomLevel();b==B.GeolocationStatus.OK?(O.moveTo(new B.LatLng(1*F[1],1*F[0])),sa.setPosition(new B.LatLng(1*F[1],1*F[0]))):4<c&&O.setZoomLevel(4)});ca&&ca.getPano(new B.LatLng(F[1],F[0]),null,function(a){T.setVisible(!1);setTimeout(function(){a?(T.setPanoId(a),T.setVisible(!0)):da.innerHTML="此处没有街景"},100)})};MI.tmpl.geolocation='<div><div class="areaWrap" id="areaWrap" style="width:600px;height:390px;padding:0;"></div><p class="detailAddress" style="margin:5px 0 10px;"></p></div>';MI.tmpl.pano='<div><div class="areaWrap pano" style="width:600px;height:390px;padding:0;"></div><p class="detailAddress" style="margin:5px 0 10px;"></p></div>';J=UI.html(MI.tmpl.geolocation)[0];U=UI.html(MI.tmpl.pano)[0];ta=e(J,".areaWrap")[0];da=e(U,".areaWrap")[0];ea=e(J,".detailAddress")[0];ua=e(U,".detailAddress")[0];UI.EA(J,"click",MI.cancelBubble);UI.EA(U,"click",MI.cancelBubble);B=soso.maps;ra=new B.Geocoder;O=new B.Map(ta,{animation:!0,center:new B.LatLng(F[1],F[0]),keyBoard:!0,scrollWheel:!0,zoomInByDblClick:!0,zoomLevel:15});new B.NavigationControl({align:B.ALIGN.TOP_LEFT,margin:new B.Size(5,15),style:B.NavigationControlStyle.SMALL,map:O});var c=new B.MarkerImage("http://mat1.gtimg.com/www/mb/images/map/fujinlogo.png",new B.Size(24,24),new B.Point(15,15),new B.Point(32,34));sa=new B.Marker({map:O,position:new B.LatLng(F[1],F[0]),icon:c,animation:B.Animation.JUMP});"1"==qa&&(T=new B.PanoramaView(da,{disableMove:!1,disableFullScreen:!1,pov:{heading:20,pitch:15,zoom:1}}),T.setVisible(!1),ca=new B.PanoramaService,c="",UI.B.ie6?c="display:inline-block":UI.B.ie8&&(c="display:inline"),X.push({tab:_('<span style="'+c+'">街景</span><sup style="vertical-align:4px;*vertical-align: 8px;_vertical-align:text-top; overflow: hidden;" class="ico_new_mini"></sup>'),content:U,tabEvent:function(){MI.Bos("btn_check_pano")}}),MI.Bos("btn_check_pano"));X.push({tab:_("地图"),content:J});va=new MI.TabDialog({width:630,list:X});va.show();a&&a();a=UI.A(b,"address")+"&nbsp;"||"&nbsp;";a='<a target="_blank" onmousedown="MI.Bos(\'btn_check_tweetNear\');" href="http://t.qq.com/map/lbs.php?'+("lat="+F[1]+"&lng="+F[0]+"&addr="+a)+'">';_("查看附近的广播");ea.innerHTML=a+_("查看附近的广播")+"</a>";ua.innerHTML=a+_("查看附近的广播")+"</a>";J.style.left=UI.getX(b)-150+"px";J.style.top=UI.getY(b)+25+"px";b=UI.getY(b)+25+220+UI.height(ea)-UI.windowHeight()-UI.scrollY();0<b&&UI.scrollTo(document.body,UI.scrollX(),UI.scrollY()+b+5);V.delay=1;setTimeout(function(){V.delay=0},100)}},O=null,sa=null,B=null,J,U,ta,da,va=null,X=[],ea,ua,F=[39.90923,116.397428],wa=!1,T,ca,ra,qa="0";MI.TalkList.prototype.geolocation={show:function(b){wa?V(b):UI.getScript("http://api.map.soso.com/v1.02/app.js",function(){V(b);wa=!0},"utf-8",1);return!1},hide:function(){0==V.delay&&UI.hide(J)}};var Y=function(){xa=setTimeout(function(){UI.hide(H)},100)},H,fa,C=[],xa,L={},P=0,K,ga,Z;MI.TalkList.prototype.download={show:function(b,a){fa=b.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(!H){MI.tmpl.download=['<div class="bigFileInfo dlLink"><b class="trib"><i class="tris"></i></b><span>',_("下载方式："),'</span><a href="#">',_("直接下载"),'</a> <a href="#">',_("旋风下载"),'</a><div class="loading" style="display:none;position:absolute;left:5%;top:5%;width:90%;height:90%;background-color:#fff;"></div></div>'].join("");H=UI.html(MI.tmpl.download)[0];C[0]=UI.GT(H,"a")[0];C[1]=UI.GT(H,"a")[1];Z=UI.GT(H,"div")[0];UI.append(H,document.body);H.onmouseout=Y;H.onmouseover=function(){clearTimeout(xa)};var c=function(){return MI.TalkBox&&MI.TalkBox.prototype&&MI.TalkBox.prototype.data&&2==MI.TalkBox.prototype.data.cflag||fa&&2==UI.A(fa,"data-zone")};MI.app({TalkBoxRich:function(){UI.EA(C[0],"click",function(a){var a=UI.E(a),b=UI.A(C[0],"dllink");Y();!c()&&MI.relay(K.id,ga,"好东西要分享，转播让你的朋友们也看看吧！");window.open(b);MI.Bos("btnFileDownloadDefault"+P);setTimeout(function(){MI.Bos("btnFileDownload",escape(K.path))},1E3);a.prevent()});UI.EA(C[1],"click",function(a){var b=UI.E(a);!c()&&MI.relay(K.id,ga,"好东西要分享，转播让你的朋友们也看看吧！");MI.App.qqDownload(C[1],a,21506);MI.Bos("btnFileDownloadXF"+P);setTimeout(function(){MI.Bos("btnQQDownload",escape(K.path))},1E3);b.prevent()})}})}var d=b.parentNode,f=e(d,".fileName")[0],g=UI.A(d,"rel");try{g=decodeURI(g)}catch(i){g=UI.text(f)}K={path:d.id,qid:UI.A(d,"qid")||0,name:g,ftype:UI.A(d,"ftype")||"1",id:UI.A(a,"id")};ga="我刚刚下载了文件【"+K.name+"】，推荐给你看看。"+UI.A(b,"href");P=0==K.qid?"0":"1";d=UI.getX(b)-10;f=UI.getY(b)+20;H.style.cssText="left:"+d+"px;top:"+f+"px;margin-left:0;";UI.show(H);var h=K;L[h.id]?(UI.A(C[0],"href",L[h.id][2]),UI.A(C[0],"dllink",L[h.id][0]),UI.A(C[0],"QHref",""),UI.A(C[1],"href",L[h.id][2]),UI.A(C[1],"QHref",L[h.id][1])):(UI.show(Z),3==h.ftype||25==h.ftype?MI.ajax({url:MI.url.applyDownloadXF,type:"get",data:{filehash:h.path,filename:h.name,R:+new Date},success:function(a){UI.hide(Z);a=MI.json(a);if(0==a.ret&&a.data){var a=a.data,b="http://t.qq.com/p/t/"+h.id+(0==h.qid?"":"/1");UI.cookie("FTN5K",a.com_cookie,1,"qq.com");UI.A(C[0],"href",b);UI.A(C[0],"dllink",a.com_url);UI.A(C[0],"QHref","");UI.A(C[1],"href",b);UI.A(C[1],"QHref",a.xf_url);L[h.id]=[a.com_url,a.xf_url,b]}else MI.alert(_("获取文件信息失败")),MI.Bos("btnFileDownloadFialXF"+P),Y()}}):MI.ajax({url:MI.url.applyDownload,type:"post",data:{fileKey:h.path,appid:0!=h.qid?1:0,qid:h.qid,ftype:h.ftype},success:function(a){UI.hide(Z);a=MI.json(a);if(0==a.result&&a.info){if(a.info.keys){var b=a.info.keys[0],c="http://"+b.attach.dns+"/ftn_handler/"+b.strKey+"/"+encodeURIComponent(h.name);UI.cookie("FTN5K",b.attach.cookies,1,"qq.com");MI.app({QQDownload:function(){var a="qqdl://"+MI.qqdl.base64encode(c),b="http://t.qq.com/p/t/"+h.id+(0==h.qid?"":"/1");UI.A(C[0],"href",b);UI.A(C[0],"dllink",c);UI.A(C[0],"QHref","");UI.A(C[1],"href",b);UI.A(C[1],"QHref",a);L[h.id]=[c,a,b]}})}}else h.qid&&-8==a.result?MI.confirm({type:"error",title:_("只有群成员才能下载该文件"),content:_(""),confirmTxt:_("申请加入"),confirm:function(){window.open("http://qun.t.qq.com/"+a.qid);MI.dialog.hide()},cancelTxt:_("取消"),cancel:function(){}}):(MI.alert(_("获取文件信息失败")),MI.Bos("btnFileDownloadFial"+P)),Y()}}));MI.Bos("btnShowDownload"+P)}};var za=function(b){for(var a="",c=0;c<b.length;c++)a+='<p><span class="cNote">'+_("译")+"：</span>"+b[c].content,a+='<br /><span class="cNote">',a+=b[c].from||"",a+="</span></p>";ya.innerHTML=a},Aa=function(){var b=UI.getY(G)+UI.height(G)-UI.windowHeight()-UI.scrollY();0<b&&UI.scrollTo(document.body,UI.scrollX(),UI.scrollY()+b+5)},Q=function(){clearTimeout(Q.delay);Q.delay=setTimeout(function(){UI.hide(G);M.style.lineHeight=1;UI.hide(M);ha=!1},100)},G,ya,ia,M,ja=null,ka={},R="",Ba=null,ha=!1,Ca=300,Da=0;MI.TalkList.prototype.trans={show:function(b){if(!ha){var a=UI.parents(b,"msgBox")[0];if(a){Ba=a.parentNode;R=UI.A(b,"tid")||e(a,".time")[0].href.replace(3===MI.hostType?/.*#id=/:/.*\//,"").split("?")[0];Da||(G||(MI.tmpl.trans=['<div class="comTips1"><div class="transWrap"><div class="transBox"></div><div class="transNote"><span class="left">',_("小贴士：越早参与翻译越容易被推荐！"),'</span><span class="right"><a class="transMe" href="#">',_("我来翻译"),'</a></span></div></div><div class="loading" style="position:absolute;width:100%;height:100%;top:0;left:0;background-color:#fff;background-position:22% 50%;"><span style="padding-left:90px;">',_("翻译机器人正在为你翻译..."),"</span></div></div>"].join(""),G=UI.html(MI.tmpl.trans)[0],ya=e(G,".transBox")[0],ia=e(G,".transMe")[0],M=e(G,".loading")[0],ia.onclick=function(){ja||(ja=new MI.TransMe("trans"));ja.show({cont:"",title:_("我来更准确的翻译:"),talkId:R,offsetY:Ca,type:1});MI.Bos("btnTransByMe");return!1},ia=null,G.onmouseout=Q,G.onmouseover=function(){clearTimeout(Q.delay);UI.show(G)},UI.clear(function(){G=null})),UI.append(G,document.body),Da=1);var a=UI.getX(b)-140,b=UI.getY(b)+25,c=UI.getX(Ba);a<c&&(a=c);a+300>c+560&&(a=c+560-300);G.style.left=a+"px";G.style.top=b+"px";Ca=b;UI.show(G);ha=!0;ka[R]?(za(ka[R]),Aa()):(a=UI.height(G),M.style.lineHeight=a-1+"px",UI.show(M),MI.ajax({url:MI.url.translate,data:{id:R},success:function(a){M.style.lineHeight=1;UI.hide(M);a=MI.json(a);if(a.result==0){za(a.info.result);ka[R]=a.info.result;Aa()}else{MI.alert(a.msg);Q()}}}));MI.Bos("btnShowTrans")}}},hide:Q};MI.TalkList.vote=function(b){var a=b.parentNode.parentNode,c=e(a,".vBox")[0],d=UI.A(a,"realurl");UI.A(a,"shorturl");UI.addClass(a,"vPlay bgr2");a='<div style="height:200px"></div><iframe width="100%" style="height:200px;display:none" onload="UI.show(this);try{var height=(this.contentWindow.document.body.scrollHeight||this.contentWindow.document.documentElement.scrollHeight)+5+\'px\';this.style.height=height;}catch(e){};UI.hide(this.previousSibling);UI.removeClass(this.parentNode,\'loading\');" src="'+d+'" frameborder="0" scrolling="no" allowtransparency="true"></iframe>';c?(UI.addClass(c,"loading"),c.innerHTML=a):UI.after(UI.html('<div class="vBox loading">'+a+"</div>")[0],b)};MI.TalkList.newVote=function(b){var a=b.parentNode.parentNode,c=e(a,".o_guess_pn")[0],d=UI.A(a,"realurl");UI.A(a,"shorturl");UI.addClass(a,"vPlay bgr2");var a=UI.parseUrl(d),f=UI.random(1,1E4),d='<div style="height:200px"></div><iframe width="460px" id="voteiframe_'+a.id+f+"\" style=\"height:200px;display:none\" onload=\"UI.show(this);try{UI.hide(this.previousSibling);UI.removeClass(this.parentNode,'loading');this.style.height=(this.contentWindow.document.body.scrollHeight || this.contentWindow.document.documentElement.scrollHeight)+5+'px';this.style.width=(this.contentWindow.document.body.scrollWidth || this.contentWindow.document.documentElement.scrollWidth)+'px';}catch(e){}\" src=\""+d+"&rand="+f+'" frameborder="0" scrolling="no" allowtransparency="true"></iframe>';c?(UI.addClass(c,"loading"),UI.show(c),c.innerHTML=d):UI.after(UI.html('<div class="o_guess_pn loading">'+d+"</div>")[0],b)};MI.TalkList.resizeVoteIframe=function(b,a){var c=j("voteiframe_"+b);if(!c)return!1;c.style.height=a+5+"px"};MI.TalkList.voteClose=function(b){UI.removeClass(b.parentNode.parentNode,"vPlay bgr2")};MI.TalkList.newVoteClose=function(b){b=b.parentNode.parentNode;UI.removeClass(b,"vPlay bgr2");UI.hide(e(b,".o_guess_pn")[0])};MI.TalkList.prototype.voteEvent=function(b){for(var a=0,c=b.length;a<c;a++){var d=b[a],f=e(d,".vtThumbs")[0];e(d,".vTools");d=e(d,".vClose")[0];f.onclick=function(){MI.TalkList.newVote(this);MI.Bos("btnVoteView");return!1};d.onclick=function(){MI.TalkList.newVoteClose(this);MI.Bos("btnVoteClose");return!1}}};MI.TalkList.fileEvent=function(b,a){for(var c=0,d=b.length;c<d;c++){var f=b[c],g=e(f,".download")[0],f=e(f,".ml10")[0];g&&(g.onclick=function(){MI.alert(_("很抱歉，文件下载功能已关闭"));return!1});f&&(f.onclick=function(){MI.TalkList.prototype.transferToMC(this,a);return false})}};MI.TalkList.prototype.transferToMC=function(b){MI.Bos("timelineMCBtn",0,0,1166);var a=b.parentNode,c=b.parentNode.parentNode.parentNode,d=c.parentNode,c=e(c,"div.userName")[0],f="";c&&(f=UI.A(c,"rel")||"");var c=e(d,".zfNum")[0]||e(d,".relay")[0]||e(d,".left .time")[0],g=(c=UI.A(c,"href"))&&"#"!=c&&0>c.indexOf("#")&&c.match(/[^\/]+$/g)[0]||UI.A(d,"id"),i=e(d,".left .f")[0],i=UI.A(i,"href"),h=c&&"#"!=c&&i.match(/[^\/]+$/g)&&i.match(/[^\/]+$/g)[0]||0;if(25==UI.A(a,"ftype"))return MI.alert("对不起，此文件无法转存<p class='cNote fs12'>微云转存暂不支持来自旋风离线分享的文件</p>"),!1;var c=a.id,k=UI.A(a,"qid")||0,i=UI.A(a,"ftype")||"1";MI.ajax({url:MI.url.applyDownload,type:"post",data:{fileKey:c,appid:0!=k?1:0,qid:k,ftype:i},success:function(c){c=MI.json(c);0==c.result&&c.info?UI.getScript("http://mat1.gtimg.com/www/mb/js/group/AntiCSRFToken_v1.0.js",function(){MI.ajax({url:"http://file.t.qq.com/air/transferToMicroCloud.php",type:"post",data:{fkey:a.id,ftype:UI.A(a,"ftype")||"0",qid:UI.A(a,"qid")||UI.A(d,"wqid")||h,token:QZFL.security.getAntiCSRFToken(),u:UI.A(a,"name")||f||""},success:function(c){c=MI.json(c);if(0==c.ret)return MI.Bos("timelineMCSucBtn",0,0,1166),MI.tip("转存成功",function(){var c=e(a,".fileName")[0],d=UI.A(a,"rel");try{d=decodeURI(d)}catch(f){d=UI.text(c)}var i,c=UI.A(b,"url")||UI.A(b,"href");i=UI.A(a,"ftype")?"#微云#我刚刚转存了文件【"+d+"】到微云[weiyun.com]，方便快捷，推荐给你看看。"+c:"#微云#我刚刚转存了文件【"+d+"】到微云[weiyun.com]，方便快捷，推荐给你看看。";setTimeout(function(){var a=b.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;!(MI.TalkBox&&MI.TalkBox.prototype&&MI.TalkBox.prototype.data&&2==MI.TalkBox.prototype.data.cflag||a&&2==UI.A(a,"data-zone"))&&MI.relay(g,i,"好东西要分享，转播让你的朋友们也看看吧！")},0)}),!0;-8==c.ret?(MI.alert("此文件太大，请使用旋风下载到本地查看<p class='cNote fs12'>文件大小超过1G，无法转存</p>"),MI.Bos("tl_over1G",0,0,1166)):1016==c.ret?(MI.Bos("tl_noMCUserBtn",0,0,1166),MI.confirm({type:"success",title:"欢迎使用微云",content:"微云会替您把文件永久保存到云端。<br>方便您在手机、电脑、web等多个终端中随时随地查看使用。",confirmTxt:"使用微云",confirm:function(){MI.Bos("tl_userMCBtn",0,0,1166);window.open("http://www.weiyun.com/disk/index.html?appid=30201")},cancelTxt:"取消",cancel:function(){}})):1053==c.ret?(MI.Bos("tl_isFull",0,0,1166),MI.alert("空间不足，暂不能转存此文件")):1051==c.ret?MI.alert("文件已转存，请前往<a href='http://www.weiyun.com/disk/index.html?appid=30201' target='_blank'>微云</a>查看"):1090==c.ret||1093==c.ret||1094==c.ret?(MI.Bos("tl_MCfail",0,0,1166),MI.alert("该文件无法转存，请下载查看")):(MI.Bos("tl_MCfail",0,0,1166),MI.alert("转存失败，请稍候再试或下载查看"));return!1}})}):k&&-8==c.result?MI.confirm({type:"error",title:_("只有群成员才能转存该文件"),content:_(""),confirmTxt:_("申请加入"),confirm:function(){window.open("http://qun.t.qq.com/"+c.qid);MI.dialog.hide()},cancelTxt:_("取消"),cancel:function(){}}):MI.alert(_("获取文件信息失败"))}})};MI.TalkList.prototype.simMusicEvent=function(b){MI.TalkList.simMusic=1;for(var a=0,c=b.length;a<c;a++){var d=b[a],f=e(d,".mThumbsBox")[0];UI.A(d,"songurl");var g=e(d.parentNode,".simPause")[0];f.onclick=function(){MI.app({Music:function(){MI.TalkList.music(d);var a=e(d,".mBoxNew")[0];a.style.height=a.style.width="1px";UI.show(g);UI.hide(f);UI.hide(e(d,".vTools")[0]);var b=0,c;c=setInterval(function(){50>b?(b++,j("musicFlash0")&&(UI.hide(e(d,".vTools")[0]),UI.A(j("musicFlash0"),"width",1),UI.A(j("musicFlash0"),"height",1),clearInterval(c))):clearInterval(c)},10)}});return!1};g.onclick=function(){MI.TalkList.musicStop();UI.hide(this);UI.show(f);return!1}}};MI.TalkList.prototype.musicEvent=function(b){for(var a=this,c=0,d=b.length;c<d;c++){var f=b[c],g=e(f,".albumInfo .mThumbsBox")[0];if(g){var i=e(f,".albumPic a")[0],h=e(f,".albumPic img")[0],k=e(f,".albumInfo .songTit a")[0];g.onclick=i.onclick=k.onclick=function(){MI.app({Music:function(){MI.TalkList.music(f)}});return!1};h&&(h.onerror=function(){this.src="http://mat1.gtimg.com/www/mb/images/music_none.png";this.onerror=null})}else{g=e(f,".mThumbsBox")[0];if(!g)break;if(!MI.user.fun.newMusic){k=e(f,".mBox")[0];e(k,".mTitBox");var i=e(k,".btn_mClose")[0],h=e(k,".btn_mPlay")[0],k=e(k,".btn_mPause_hover")[0],l=e(f.parentNode.parentNode,".msgCnt .ico_music")[0]||e(f.parentNode.parentNode,".msgCnt .ico_qlz")[0];g.onclick=h.onclick=function(){MI.app({Music:function(){MI.TalkList.music(f)}});return!1};l&&(l.onclick=function(){if(f&&f.isOpen)try{a.musicClose()}catch(b){}else a.music(f);return!1});k.onclick=function(){MI.TalkList.musicStop();return false};i.onclick=function(){MI.TalkList.musicClose()}}g=e(f.parentNode.parentNode,".msgCnt .ico_qlz");UI.each(g,function(a){a.title=_("绿钻贵族分享的高品质音乐，欢迎收听")})}}};MI.TalkList.openMedia=function(b){b&&(b=e(b,".videoBox .vThumbsBox,.videoBox .vtThumbs,.musicBox .mThumbsBox,.picBox .pic,.orderWrap,.rich_mod")[0])&&UI.fireEvent(b,"click")};MI.mediaMutex=function(b,a){if(b){var c=UI.closest(b,".multiMedia"),d=!1,f,g=!1,e=UI.parents(b,"msgBox")[0];if(5==MI.api.type||MI.user.fun.bigPicMode){d=!0;e=UI.closest(b,".msgBox");if(MI.user.fun.newImgTmpl||MI.user.fun.bigPicMode)g=UI.hasClass(b,"vThumbsBox"),f=UI.GC(e,".mediaWrap")[0];c=UI.GC(e,".multiMedia")[0]}if(e&&(c||f)){var h;UI.each({mPic:[".picBox .pic"],mVideo:[".videoBox .vThumbsBox"],mMusic:[".musicBox .mThumbsBox"],mPics:[".tl_imgGroup_link img"],mPVote:[".tl_picVote"],mRich:[".orderWrap",".rich_mod"]},function(a,d){UI.removeClass(c,d);UI.each(a,function(a){UI.isSelector(b,a)&&(h=d)})});(a=a||UI.hasClass(c,"mMOpen"))?(UI.removeClass(c,"mMOpen"),d&&(UI.show(UI.GC(e,".mediaWrap")[0]),UI.show(UI.GC(e,".picBox")[0]))):(UI.addClass(c,"mMOpen"),h&&UI.addClass(c,h),d&&(g?UI.hide(UI.GC(e,".picBox")[0]):UI.hide(UI.GC(e,".mediaWrap")[0])))}}};MI.TalkList.videoUrlVoid=function(b){var b=b.match(/http:\/\/([^\/]+)\//i),a="";if(!b[1])return a;for(var c="qq.com tudou.com youku.com 56.com tudou.com ku6.com yinyuetai.com sohu.com joy.cn 6.cn".split(" "),d=0,f=c.length;d<f;d++)if(RegExp(c[d]).test(b[1])){a=c[d].split(".")[0];break}return a};MI.TalkList.videoVid=function(b){var a="",b=b.split("?")[1].match(/(^|&)vid=([^&]*)(&|$)/);b[2]&&(a=b[2]);return a};MI.TalkList.videoMsgId=function(b){var a="",b=b.split("?")[1].match(/(^|&)msgid=([^&]*)(&|$)/);b[2]&&(a=b[2]);return a};MI.TalkList.video=function(b,a){try{MI.TalkList.musicStop()}catch(c){}try{MI.TalkList.musicClose()}catch(d){}try{MI.TalkList.videoClose()}catch(f){}var g;1==a?g=e(b.parentNode.parentNode,".videoBox")[0]||e(UI.closest(b,".msgBox"),".videoBox")[0]:2==a&&(g=b.parentNode.parentNode);g.isOpen=!0;MI.TalkList.lastVideo=g;g=g.getAttribute("playurl");var i;"qq"==MI.TalkList.videoUrlVoid(g)&&UI.B.ipad?(g="http://vv.video.qq.com/geturl?vid="+MI.TalkList.videoVid(g)+"&callvar=QZOutputJson&otype=json&r="+MI.random(),UI.getScript(g,function(){(i=QZOutputJson.vd.vi[0].url)&&MI.TalkList.videoOpen(b,a,i,"mp4")})):""!=MI.TalkList.isWeShow(b)&&UI.B.ipad?(window.wsMp4OutputJson=function(c){if(c.ret==0){i=c.data.url[0];MI.TalkList.videoOpen(b,a,i,"mp4")}},g="http://wsm.qq.com/weishi/video/downloadVideo.php?vid="+MI.TalkList.videoVid(g)+"&id="+MI.TalkList.videoMsgId(g)+"&callback=wsMp4OutputJson",UI.getScript(g,function(){})):MI.TalkList.videoOpen(b,a,g,"flash");UI.linkEvent("MI.TalkList.video",{target:b});return!1};var la;MI.TalkList.videoOpen=function(b,a,c,d){var f;f="mp4"==d?MI.tmpl.videoHTML5:UI.B.ie&&11>UI.B.ie?MI.tmpl.videoObject:MI.tmpl.videoEmbed;var g,i,h;1==a?g=e(b.parentNode.parentNode,".videoBox")[0]||e(UI.closest(b,".msgBox"),".videoBox")[0]:2==a&&(g=b.parentNode.parentNode);g.className.hasString("prizeCont")&&(la||(la=f.replace(/height="\d+"/,'height="345"')),f=la);var k=e(g,".vWrap")[0];i=e(g,".vBox")[0];var l=e(g,".vThumbsBox")[0],j=UI.html('<div class="vBox" style="display:block"></div>')[0],m=unescape(g.getAttribute("minipicurl")),n=c?c:unescape(g.getAttribute("playurl")),q=unescape(g.getAttribute("realurl")),r=g.getAttribute("title")?g.getAttribute("title"):g.getAttribute("reltitle");MI.string.cut(r,40);var r=unescape(g.getAttribute("shorturl")),o=g.getAttribute("playurl"),c=MI.TalkList.videoUrlVoid(c),p="VideoPlay"+MI.random(),A="qq"==c?"&amp;outhost="+encodeURIComponent(location.href):"",w="",s="",z="";if("qq"==c&&(w='<param name="allowScriptAccess" value="always" />',s='allowScriptAccess="always"',"mp4"!=d)){var y=UI.parents(b,"msgBox")[0],y=e(y,".vTools .vUrl")[0];""!=MI.TalkList.isWeShow(b)&&(n=n.replace(/static.video.qq.com\/qqplayerout.swf/g,"mat1.gtimg.com/weishi/player/TPweishi.swf").replace(/static.video.qq.com\/TPout.swf/g,"mat1.gtimg.com/weishi/player/TPweishi.swf"),f=f.replace(/height="\d+"/,'height="494"'),UI.A(y,"href","http://www.weishi.com/?pgv_ref=weishi.video.upright"),y.innerHTML="<em></em>微视 8秒无限欢乐",z="&amp;showend=0&amp;share=0",MI.Bos("showWeishiTP"))}f=f.replace(/\$allowScriptAccessIE/g,w).replace(/\$allowScriptAccessWb/g,s).replace(/\$showend/g,z);switch(c){case "tudou":o.split("/");break;case "ku6":o.split("/");break;case "joy":o.split("/")[4].slice(0,7);break;case "sohu":o.split("/");break;case "yinyuetai":o.split("/")}if(1==a){a=e(g,".vTools")[0];h=f.replace(/\$VideoPlayID/g,p).replace(/\$VideoPlayUrl/g,n).replace(/\$MiniPic/g,m).replace(/\$outhost/g,A);l&&UI.hide(l);UI.show(a);if(g.play){d=e(b.parentNode.parentNode,".videoBox")[0]||e(UI.closest(b,".msgBox"),".videoBox")[0];d=e(d,".vClose")[0];try{MI.TalkList.videoClose(d,1)}catch(D){}g.play=0;return!1}i||UI.append(j,k)}else if(2==a){b=e(g,".vTools")[0];h=f.replace(/\$VideoPlayID/g,p).replace(/\$VideoPlayUrl/g,n).replace(/\$outhost/g,A);if(g.play)return g.play=0,!1;UI.hide(l);b.style.display="block";i||UI.append(j,k)}g.play=1;UI.addClass(g,"vPlay bgr2");UI.B.ipad||UI.addClass(e(g,".vBox")[0],"loading");if(UI.B.ipad&&"flash"==d||MI.noFlash()&&"mp4"!=d)h='<div style="font-size:14px;padding:20px 0;background:#F9F9F9;margin:5px;">'+_("对不起，由于您的浏览器未安装Flash播放器，不支持播放。<br>建议您尝试来源网页：")+'<a href="http://url.cn/'+r+'" target="_blank">http://url.cn/'+r+"</a></div>";j.innerHTML=h;MI.mediaMutex(l);MI.Bos("btnVideoView",escape(q));MI.user.fun.newImgTmpl&&("qq"==c?MI.Bos("btnPicBigTVideo"):MI.Bos("btnPicBigNTVideo"));return!1};MI.noFlash=function(){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){for(var b=navigator.plugins["Shockwave Flash"].description.split(" "),a=0;a<b.length;++a)if(!isNaN(parseInt(b[a])))var c=b[a];var d=6<=c}else if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),d=!0}catch(f){d=!1}MI.noFlash=function(){return!d};return d?!1:!0};MI.TalkList.videoClose=function(){var b=MI.TalkList.lastVideo;e(b,".vWrap");var a=e(b,".vBox")[0],c=e(b,".vThumbsBox")[0],d=e(b,".vTools")[0],f=e(c,".vThumbs")[0];e(f,"img");b.play=0;UI.removeClass(b,"vPlay bgr2");UI.removeClass(a,"loading");c.style.display="inline";d.style.display="none";UI.remove(a);MI.mediaMutex(c,1);MI.TalkList.lastVideo.isOpen=!1;UI.linkEvent("MI.TalkList.videoClose");return!1};MI.TalkList.prototype.newly=function(){var b=this,a=b._new,c;c="";if(!a.sending)if(15<a.num||b.refresh){if(UI.isFunction(b.refresh)){b.refresh(a);return}if(UI.isFunction(b.refreshAll)){b.refreshAll(a);return}if(b.refreshUrl&&UI.isString(b.refreshUrl)&&(c=b.refreshUrl+(b.refreshUrl.hasString("?")?"":"?"),MI.newCount.data))for(var d in MI.newCount.data)c+="&"+d+"="+MI.newCount.data[d];document.location.href=UI.isString(b.refreshUrl)?c:"/"+MI.user.account}else if(UI.addClass(a,"loading"),b.pageModeCur&&1!=b.pageModeCur)UI.fireEvent(e(b._pageNum,"a")[1],"click"),UI.hide(a);else{if(c=e(b._new,"strong")[0])c.innerHTML="";c={time:b.first.time,id:MI.string.parseInt(b.first.id),isrecom:MI.string.parseInt(b.first.recom),p:2,type:1};if(MI.newCount.data)for(d in MI.newCount.data)c[d]=MI.newCount.data[d];b.xhr["new"]=MI.ajax({url:b.newlyUrl,type:"get",data:c,fail:function(){UI.removeClass(b._new,"loading");b._new.sending=0},success:function(a){b.addNewly(a);b._new.sending=0;UI.linkEvent("MI.TalkList.newly")}})}a.sending=1};MI.TalkList.prototype.addNewly=function(b){var a=this,c=a._new,d=UI.isString(b),f=d?MI.json(b):b;if(a.tmpl){a.newlyCall&&a.newlyCall(f);if(0==f.result){f.info.guest=a.guest;f.info.fav=0;f.info.shield=0;f.info.iconPic=a.iconPic;f.info.type=a.type;f.info.isReply=a.isReply;f.info.isMyLike=!!a.isMyLike;f.info.hasLike=!!a.hasLike;UI.each(a.tmplData,function(a,b){f.info[b]=a});MI.addImgProperty(f.info.talk);if(!a.guest&&f.info.user!=MI.user.account){document.location.reload();return}var g,i=document.createDocumentFragment(),h=UI.html(UI.txTpl(a.tmpl,f.info).replace(/<li id="/gi,d?'<li class="bor2 newMsg bg4 bor_bg5" id="':'<li id="')),k=f.info.talk.length;if(k){a._newLine&&UI.removeClass(a._newLine,"pageLine");for(var l=g=0,m=h.length;l<m;l++)a.merge(h[l].id),a.addEvent(h[l]),2==UI.A(h[l],"tv")&&g++,UI.append(h[l],i),l==m-1&&(a._newLine=h[l],UI.addClass(h[l],"pageLine"));g&&MI.Bos({id:1192,name:"btnFlowMsgAd",sBak1:"new",iBak1:g});50<k&&(a._body.innerHTML="");g=a._news;l=0;for(m=g.length;l<m;l++)UI.removeClass(g[l],"newMsg bg4 bor_bg5");UI.prepend(i,a._body);a.addFollowBtn(h);a._news=e(a._body,".newMsg");a.news=a._news.length;UI.each(a.add,function(a){j(a)&&UI.removeClass(j(a),"newMsg bg4 bor_bg5")});a.cacheFirst();a.add=[];a._tip&&UI.hide(a._tip);a.updateTime(f.info.time);i="new";a.pv&&(i+="/"+a.pv);MI.PV(a.pvOther||i);MI.Crs(1);d&&(MI.ajaxTimes++,MI.talkNew.push(b));c&&c.num!=k&&MI.Bos("btnNewTalkNumError")}}c&&(UI.hide(c),UI.removeClass(c,"loading"));document.titleTmp&&(document.title=document.titleTmp);MI.newCountNum=0;a.bottom();UI.linkEvent("MI.TalkList.resize");UI.linkEvent("MI.TalkList.more",f)}else MI.app("Tmpl",function(){a.tmpl=MI.tmpl.listAll;a.addNewly(b)})};MI.TalkList.prototype.more=function(b){var a=this;UI.children(a._body);var c;if(a.hasNext){c=a.last.fav?a.last.fav:a.last.shield?a.last.shield:a.last.time;c={time:c,page:a.page+1,id:MI.string.parseInt(a.last.id),isrecom:MI.string.parseInt(a.last.recom)};var d=UI.A(a._more,"rel"),f,g,e,h;a.guest&&(c.u=a.guest);MI.Group&&"undefined"!=typeof MI.Group.viewMode&&(c.mode=MI.Group.viewMode);a._more.sending||(a.moreLoading(),d&&(f=+new Date,a.moreAjax=MI.ajax({url:d,type:"get",data:c,timeout:3E4,fail:function(){a.moreLoading(1);a._more.sending=0},success:function(b){g=+new Date-f;MI.app("Tmpl",function(){if(!a.tmpl)a.tmpl=MI.tmpl.listAll;a.addMore(b)});e=+new Date-f;setTimeout(function(){h=+new Date-f;MI.Speed("t_asyn_more",0.005,g,e,h)},0)}}),MI.Bos(b?"btnMoreAuto":"btnMore","",0.01)));a._more.sending=1}};MI.TalkList.prototype.moreLoading=function(b){b?(UI.removeClass(this._more,"loading c_tx5"),UI.addClass(this._more,"c_tx2")):(UI.addClass(this._more,"loading c_tx5"),UI.removeClass(this._more,"c_tx2"))};MI.TalkList.prototype.addMore=function(b,a){var c=this,d=UI.isString(b),f=UI.children(c._body),f=f[f.length-1],g=d?MI.json(b):b;if(c.tmpl){c.pageModeShow&&c.pageModeShow(b);c.moreCall&&c.moreCall(g);if(0==g.result){if(!c.guest&&g.info.user!=MI.user.account){document.location.reload();return}g.info.guest=c.guest;g.info.fav=c.last.fav?1:0;g.info.iconPic=c.iconPic;g.info.type=c.type;g.info.shield=c.last.shield?1:0;g.info.pubDate=c.last.pubDate;g.info.isReply=c.isReply;g.info.isMyLike=!!c.isMyLike;g.info.hasLike=!!c.hasLike;UI.each(c.tmplData,function(a,b){g.info[b]=a});MI.addImgProperty(g.info.talk);var e=document.createDocumentFragment(),h=UI.html(UI.txTpl(c.tmpl,g.info));if(g.info.talk.length){for(var k=0,l=0,m=h.length;l<m;l++)c.merge(h[l].id),UI.append(h[l],e),2==UI.A(h[l],"tv")&&k++;k&&MI.Bos({id:1192,name:"btnFlowMsgAd",sBak1:"more",iBak1:k});setTimeout(function(){for(var a=0,b=h.length;a<b;a++)c.addEvent(h[a]);MI.Crs(1);setTimeout(function(){UI.linkEvent("MI.TalkList.resize")},1E3)},0);UI.append(e,c._body);c.addFollowBtn(h);UI.C(c._body,"marginBottom","");MI.dialog&&MI.dialog.display&&MI.dialog.resizeBg();a||(e="more",c.pv&&(e+="/"+c.pv),5===MI.api.type&&(e="mb/qzone/"+e),MI.PV(c.pvOther||e));d&&(MI.ajaxTimes++,MI.talkMore.push(b))}0==g.info.hasNext||!g.info.talk.length?(c._more&&UI.addClass(c._more.parentNode,"hide"),c.hasNext=0):(1==g.info.hasNext&&(c._more&&UI.removeClass(c._more.parentNode,"hide"),c.hasNext=1),f&&UI.addClass(f,"pageLine"),c.cacheLast());c.updateTime(g.info.time);c.page++}c.pageModeCur||(c.moreTimes++,MI.user.fun.autoMoreContinue&&c.moreTimes>MI.autoMoreTimes&&(c.moreTimes=0));c.bottom();c.moreLoading(1);c._more&&(c._more.sending=0);UI.linkEvent("MI.TalkList.resize");UI.linkEvent("MI.TalkList.more",g)}else MI.app("Tmpl",function(){c.tmpl||(c.tmpl=MI.tmpl.listAll);c.addMore(b,a)})};MI.TalkList.prototype.updateTime=function(b){b&&(b=Number(b),MI.time=b,UI.each(this.time,function(a){var b;b=MI.time;var d=new Date,f=UI.A(a,"rel"),e=UI.zoneDate(f+"000",8),i=b-f,f=parseInt(i/60);parseInt(i/3600);var i=parseInt(i/86400),h=a.title.split(" ")[1];d.setTime(b+"000");if(b=0>=f?_("刚刚"):60>f?1<f?f+_('分钟前<i class="l"></i>'):f+_("分钟前"):59<f&&0==i?(d.getDate()==e.getDate()?_("今天"):_("昨天"))+" "+h:1==i&&2>d.getDate()-e.getDate()?_("昨天 ")+h:d.getFullYear()==e.getFullYear()?a.title.split(_("年"))[1]:a.title)a.innerHTML=b}))};MI.TalkList.prototype._pageMode=function(b){function a(){c.pageModeData&&c.pageModeData.page&&(c.pageModeCur=c.pageModeData.page);c.xhr.pageMode&&c.xhr.pageMode.abort();c.xhr.pageMode=MI.ajax({url:UI.A(c._more,"rel"),data:c.pageModeData||"",type:"get",success:function(a){a=MI.json(a);c.pageModeData?c.addMore(a):c.pageModeShow(a)}})}var c=this,b=b||{};c.pageModeCur=1;c._page=UI.html('<div><div id="pageNav" class="blueFoot" style="padding:0 40px 0 0;border:0;width:600px;background:none;margin-bottom:-9px"></div></div>')[0];c._pageNum=c._page.firstChild;UI.after(c._page,b.target||c._body.parentNode);c.auto=0;c._more&&setTimeout(function(){UI.remove(c._more.parentNode)},0);c._pageNum.onclick=function(d){d=UI.E(d).target;if("A"==d.nodeName)return c.pageModeData=MI.json(UI.A(d,"rel")),d=UI.height(c._body),c.clear('<li class="loading2" style="height:'+(700<d?d:700)+'px;background-position:50% 100px;border-bottom:0!important;">&nbsp;</li>'),window.scrollTo(0,c.pageModeTop||0),a(),b.call&&b.call(c.pageModeCur),!1};c.pageModeLoaded||(c.pageModeData="",a(),c.pageModeLoaded=1)};MI.TalkList.prototype.pageModeShow=function(b){if(!this.pageModeCur||!b.info||!b.info.page)UI.hide(this._page);else{var a=this,c=b.info.page.pages,d=b.info.page.prev,f=b.info.page.next,g=[],i,h=1;a.pageModeCur=b.info.page.page;if(c){var k=function(a){a.id||delete a.id;a.time||delete a.time;a.isrecom||delete a.isrecom;return UI.json2str(a)};1!=a.pageModeCur&&d&&g.push('<a href="#" rel=\''+k(d)+'\' class="pageBtn" boss="btnTalkListPrev" title="'+_("上一页")+'"><<</a>');UI.each(c,function(b){var c="";1==b.page&&(i=1);if(1<=b.page-h){if(1<b.page-h||!i)g.push('<a href="#" rel=\''+c+'\' boss="btnTalkListPage">1</a>'),i=1;1<b.page-h&&g.push("<span>...</span>")}c=k(b);a.pageModeCur==b.page?g.push("<strong>"+b.page+"</strong>"):g.push('<a href="#" rel=\''+c+'\' boss="btnTalkListPage">'+b.page+"</a>");h=b.page});f?(f.page!=h&&g.push("<span>...</span>"),g.push('<a href="#" rel=\''+k(f)+'\' class="pageBtn pageBtnNext" style="display:none" boss="btnTalkListNext">'+_("下一页")+" >></a>"),a._pageNext||(a._pageNext=UI.DC("div"),UI.after(a._pageNext,a._pageNum),UI.EA(a._pageNext,"click",function(b){(UI.E(b).target.nodeName="A")&&UI.fireEvent(e(a._pageNum,".pageBtnNext")[0],"click")})),a._pageNext.innerHTML='<div class="moreFoot"><a href="javascript:void(0)" class="ffsong" boss="btnTalkListNext">'+_("下一页")+" >></a></div>",UI.show(a._pageNext)):UI.hide(a._pageNext)}a._pageNum.innerHTML=g.join("");a.pageModeData&&(a.clear(),b=a.pageModeTop||0,c=UI.scrollY(),0<=c&&c<b&&(b=c),window.scrollTo(0,b),MI.Crs.iconPic="x");UI.hide(a._new);UI.removeClass(a._new,"loading")}};MI.TalkList.prototype.miniModel=function(b){var b=b||{},a=this,c=a.eventCall,d=/(\(\d*\))/gi,f=function(a,c){a&&(a.onclick=null,a.href=" "+c,a.target="_blank",b.bosName&&(a.onmousedown=function(){MI.Bos(b.bosName)}))};a.eventCall=function(g){c&&UI.isFunction(c)&&c.call(a,g);var i="http://t.qq.com/p/t/"+MI.string.parseInt(g.id),h=e(g,".areaInfo,.btn_trans,.pubDate");UI.each(h,function(a){UI.hide(a)});b.useRichMedia||(h=e(g,"canvas"),UI.each(h,function(a){UI.hide(a)}));b.showRelayComtNum||(h=e(g,".relay,.comt,.reply"),UI.each(h,function(a){var b=a.innerHTML,b=b.replace(d,"");a.innerHTML=b}));h=e(g,".mod_tl_recom .userPic");UI.each(h,function(a){a.style.display="block"});var h=e(g,".left .zfNum"),k=UI.hasClass(g,"wqprivate");b.useQunUrl&&k&&UI.each(h,function(a){UI.hide(a);UI.hide(a.parentNode.parentNode)});UI.each(e(g,".left"),function(a){a.clientHeight==0&&!UI.hasClass(a.parentNode,"rich_mod_opt")&&UI.hide(a.parentNode)});setTimeout(function(){var a=e(g,".detail_link a");UI.each(a,function(a){f(a,i)});if(!b.useRichMedia){a=e(g,"a.ico_video,.vThumbsBox,.musicBox .mThumbsBox,.vtThumbs,.albumPic a,.songTit a,.mThumbsBox");UI.each(a,function(a){f(a,i)});a=e(g,"a.pic");UI.each(a,function(a){UI.A(a,"href");f(a,i);b.checkPicInFullScreen?a.onclick=function(a){var b=g.id.match(/([0-9]{5,})($|\D)/),c=UI.A(g,"data-pv-ids"),d=UI.A(g,"data-pv-comt"),f={showCount:true};UI.E(a).stop();if(c)f.idList=c.split(",");f.defaultComt=!!d;MI.cPlayer.view(b&&b[1],f);return false}:a.href=a.href+"?funBox=none"});if(a=e(g,".vtThumbs img")[0])a.onclick=null}if(a=e(g,".view")[0])a.target="_blank";if(b.userOpenWin){a=e(g,".userName a,.msgCnt strong a,.msgCnt a");UI.each(a,function(a){a.target="_blank";if(b.bosName)a.onmousedown=function(){MI.Bos(b.bosName)}})}},10);if(b.useModel){var l=MI.string.parseInt(g.id),h=e(g,".funBox a.relay"),m=a.relayBox&&a.relayBox.data?a.relayBox.data.pgv_ref:"",j=function(a,b,c){MI.ajax({url:MI.url.relayList,data:{id:a,attr:1},type:"get",async:false,success:function(a){a=MI.json(a);MI.Bos("getAuthCheck_wideR_float",0,0,214);var d={},f=0;if(a.result==0){d["0"]=a.attr&&a.attr.fCom?1:0;d["1"]=a.attr&&a.attr.fRt?1:0;d[b]&&(f=1)}if(f){a=_("由于用户设置，你无法{0}此微博",b?_("转播"):_("评论"));MI.Bos("showTips_wideR_float",0,0,214);MI.alert(a);return false}c&&c()},fail:function(){c&&c()}})};UI.each(h,function(b){UI.A(b,"clickE",1);b.onclick=function(){j(l,1,function(){var b="";e(g,".replyBox")[0]&&(b=a.getRelayOld(g,".msgCnt"));MI.relay(l,b,"",m);return false})}});h=e(g,".funBox a.comt");UI.each(h,function(b){UI.A(b,"clickE",1);b.onclick=function(){j(l,0,function(){var b="";e(g,".replyBox")[0]&&(b=a.getRelayOld(g,".msgCnt"));MI.comment(l,b,"",m);return false})}});var h=e(g,".funBox a.reply"),k=e(g,".userName strong a")[0],n="";k&&(n=k.innerHTML);UI.each(h,function(a){UI.A(a,"clickE",1);a.onclick=function(){MI.reply(l,n,"",m);return false}})}};a.eventsCall=function(){setTimeout(function(){MI.Crs(1,a._body)},200)};b.useRichMedia||(a.musicEvent=function(){},a.voteEvent=function(){});return a.eventCall}})();MI.TalkList.prototype.showReadList=function(j,e){var y=this,p="read_del_"+MI.Uin();MI.ajax({url:MI.url.readList,type:"get",data:{_r:MI.random(),id:j},success:function(w){var m,n,o,D;if((w=MI.json(w))&&0===w.result&&!(5!==y._collapseType||!y._collapseTarget||!y._collapseTarget.href||-1===y._collapseTarget.href.indexOf(j))){m=w.info.user;UI.each((MI.S(p)||"").split("#"),function(e){e&&(e=e.split("@"))&&e[0]===String(j)&&(D=e[1])});w.info.owner!==MI.user.account&&w.info.show&&(!D||6E5<+new Date-D)?m.unshift({miniUrl:MI.user.pic.replace(/\/[0-9]+$/,""),nick:MI.user.name,id:MI.user.account}):1===m.length&&m[0].id===MI.user.account&&(m=[]);n=[];m.length?(UI.each(m,function(e,m){var j,o,p=e.id===MI.user.account;0<m&&p||9<n.length||(p?(o=_("删除我的阅读记录"),j="javascript:;"):(o=e.nick.toTitle()+"(@"+e.id+")",j=MI.getInternalUrl(0,e.id),j+=(-1<j.indexOf("?")||-1<j.indexOf("#")?"&":"?")+"&from=readnum"),e.avatar=e.miniUrl&&0>e.miniUrl.indexOf("head_normal_")&&0>e.miniUrl.indexOf("images/head")?e.miniUrl+"/20":"http://mat1.gtimg.com/www/mb/img/p1/head_normal_20.png",n.push(['<span class="recent_link"><a href="',j,'" title="',o,'" class="need-card5" boss="btnReadUser"><img height="20" width="20" src="',e.avatar,'"></a>',p?'<a class="read_close" boss="btnReadDel" title="'+_("删除我的阅读记录")+'" href="Javascript:;">x</a>':"","</span>"].join("")))}),m=n.join("")+_(" 最近读过")+'<a title="阅读设置" class="btn_moreSet" href="http://p.t.qq.com/setting/privacy?readlist=1'+(5==MI.api.type?"&pgv_ref=web.qzoneapp.setting":"")+'#readList" target="_blank" boss="btnReadSet"></a>'):m=_("暂无阅读记录");o=y._readList;o||(o=y._readList=UI.html('<div class="pubInfo recent_read c_tx3"></div>')[0]);o.innerHTML=m;MI.app({Base:function(){MI.Card.build(o,".need-card5",5)}});var E=$$(o,"a")[0];E&&setTimeout(function(){MI.focus(E)},0);var s,z,I;if(s=UI.GC(o,".read_close")[0])z=s.parentNode,z.onclick=function(){MI.ajax({url:MI.url.delReadList,type:"get",data:{_r:MI.random(),id:j},success:function(e){var m=false;if((e=MI.json(e))&&e.result===0){MI.tip(_("删除成功"));UI.GC(z.parentNode,".recent_link").length===1?z.parentNode.innerHTML=_("暂无阅读记录"):UI.remove(z);var n=MI.S(p)||"";if(n){n=n.split("#");UI.each(n,function(e,o){e=e.split("@");if(e[0]===j){n[o]=+new Date;m=true}})}else n=[];if(!m){for(;n.length>19;)n.shift();n.push(j+"@"+ +new Date)}MI.S(p,n.join("#"))}}})},UI.B.ie6&&(z.onmouseover=function(){clearTimeout(I);s.className="read_close hover"},z.onmouseout=function(){I=setTimeout(function(){s.className="read_close"},100)});e&&e(o,w.info.total||n.length);y.curReadList=j;UI.show(o)}}})};MI.TalkList.prototype._collapseTarget=null;MI.TalkList.prototype._collapseType=0;MI.TalkList.prototype.collapseInit=function(){this._collapseTarget=null;this._collapseType=0;this._collapseMulti={}};MI.TalkList.prototype.collapse=function(j,e,y){var p,w;this.relayListMulti&&y&&this._collapseMulti&&this._collapseMulti[y]?(p=this._collapseMulti[y].type,w=this._collapseMulti[y].target):(p=this._collapseType,w=this._collapseTarget);1==p||2==p||3==p?(this.replyHide(),this.xhr.comt&&this.xhr.comt.abort()):4==p?this.relayListHide(y):5==p?(UI.A(j,"title","查看最近阅读"),UI.hide("readnum-tip"),UI.hide(this._readList)):6==p&&UI.hide(this._likeList);if(w==j)return this.collapseInit(),!1;this.relayListMulti&&y?(this._collapseMulti||(this._collapseMulti={}),this._collapseMulti[y]={target:j,type:e}):(this._collapseTarget=j,this._collapseType=e);return!0};MI.TalkList.prototype.like=function(){var j=function(e,p,w,m){var n={_r:MI.random(),pid:e,like:p?0:1};m&&(n.veriCode=m);MI.ajax({url:MI.url.like,type:"post",data:n,success:function(m){m=MI.json(m);MI.code.check(m.result)&&MI.code.show({msg:m.msg,code:m.info,call:function(m){j(e,p,w,m)}});w&&w(m);m.result==0&&UI.linkEvent("MI.TalkList.like",{target:$(e),isLike:p})}})},e=function(e,p){UI.A(p,"loading")||(UI.A(p,"loading",1),j(e,!0,function(e){var m=p.parentNode,j=UI.next(m),o,y;UI.A(p,"loading","");if(j&&e&&(e.result===0||e.result===-10)){o=UI.GC(m,".like_plus")[0];UI.show(j);o.style.marginTop="-10px";o.style.display="block";y=UI.GT(j,"span")[0]||{};if(e.result===0){if(e=UI.hasClass(m.parentNode,"left")){m.style.position="relative";if(!UI.B.ie||document.documentMode>7)o.style.left="0px"}UI.animate(o,"marginTop",-35,function(){UI.hide(o);y.innerHTML=parseInt(y.innerHTML,10)+1},0.2)}else if(e.result===-10){UI.hide(o);if(y.innerHTML==="0")y.innerHTML="1"}UI.removeClass(p,"ico_likeb");UI.removeClass(j,"num_likeb");UI.addClass(j,"int_havelike");UI.addClass(p,"ico_likea");j.title=m.title=_("取消赞");MI.Bos({name:"btnLikeYes",id:1192});MI.Bos("btnLikeYes")}}))};e.unlike=function(e,p){var w=this;UI.A(p,"loading")||(UI.A(p,"loading",1),j(e,!1,function(e){var j=p.parentNode,o=UI.next(j),y;UI.A(p,"loading","");if(o&&e&&e.result===0){y=UI.GT(o,"span")[0]||{};e=parseInt(y.innerHTML,10)-1;if(isNaN(e)||e<1)e=0;y.innerHTML=e;y.innerHTML==="0"&&UI.hide(o);UI.removeClass(p,"ico_likea");UI.removeClass(o,"int_havelike");UI.addClass(p,"ico_likeb");UI.addClass(o,"num_likeb");o.title=j.title=_("赞");w._collapseTarget===o&&w._collapseType===6&&w.collapse(o,6);MI.Bos({name:"btnLikeNo",id:1192});MI.Bos("btnLikeNo")}}))};e.showList=function(e,j){var w=this;MI.ajax({url:MI.url.readList,type:"get",data:{_r:MI.random(),type:1,id:e},success:function(m){var n,o=[],D,E;if((m=MI.json(m))&&0===m.result){n=m.info.user;n.length?(UI.each(n,function(e){var j,m;9<o.length||(e.nick=e.nick||"",m=e.nick.toTitle()+"(@"+e.id+")",j=MI.getInternalUrl(0,e.id),j+=(-1<j.indexOf("?")||-1<j.indexOf("#")?"&":"?")+"&from=likenum",e.avatar=e.miniUrl&&0>e.miniUrl.indexOf("head_normal_")&&0>e.miniUrl.indexOf("images/head")?e.miniUrl+"/20":"http://mat1.gtimg.com/www/mb/img/p1/head_normal_20.png",o.push(['<span class="recent_link"><a href="',j,'" title="',m,'" class="need-card5" boss=""><img height="20" width="20" src="',e.avatar,'"></a></span>'].join("")))}),E=parseInt(m.info.total,10),E=isNaN(E)?"":E,m=o.join("")+'<a href="'+MI.getInternalUrl(1,e,"/?filter=8")+'" target="_blank">'+_((10<E?" 等":" ")+E+"人觉得很赞")+"</a>"):m=_("暂无赞记录");D=w._likeList;D||(D=w._likeList=UI.html('<div class="pubInfo recent_read c_tx3"></div>')[0]);D.innerHTML=m;MI.app({Base:function(){MI.Card.build(D,".need-card5",5)}});var s=$$(D,"a")[0];s&&setTimeout(function(){MI.focus(s)},0);j&&j(D,E||o.length);UI.show(D)}}})};e.doLikeRequest=j;return e}();MI.TalkList._showPicPreview=function(){var j=null,e=null,y,p,w;p=function(m){var n,o,D,E,s,z=function(){j=setTimeout(function(){UI.hide(n);e=null},100)};E=UI.A(m,"data-rpurl");clearTimeout(j);n=UI.G("mi-tl-picpreview");n||(n=document.body.appendChild(UI.html('<div id="mi-tl-picpreview" class="pop_img_drop"></div>')[0]),n.onmouseover=function(){clearTimeout(j)},n.onmouseout=z);n.onclick=function(){p.click(m)};e!==m&&(n.innerHTML='<img src="'+E+'/160">',o=UI.getX(m),D=UI.getY(m)+16,m.onmouseout=z,m.onclick=function(){p.click(this)},s="display:block;top:"+D+"px;left:"+o+"px;z-index:1000",n.style.cssText=s,w=new Image,w.onload=function(){if(y===E){var e;e=window.innerWidth;var j=document.compatMode;if(j||UI.B.ie)e=j==="CSS1Compat"?document.documentElement.clientWidth:document.body.clientWidth;j=w.width+8;if(o+j>e)n.style.cssText=s+";left:"+(e-j)+"px"}},w.src=E+"/160",e=m,y=E)};p.click=function(e){for(var j=e;j&&!j.id;)j=j.parentNode;j&&(j.id&&j.id.match(/([0-9]{5,})($|\D)/))&&(j=RegExp.$1,UI.A(e,"data-rpurl"),e=UI.A(e,"data-rpid"),MI.cPlayer.view(j+"-r"+e,{showCount:!0}),p.hide(),MI.Bos("btnClickRtPics"));this.hide()};p.hide=function(){UI.hide(UI.G("mi-tl-picpreview"))};return p}();/*  |xGv00|af2039b8be16e50c84441c9f7f8907ac */